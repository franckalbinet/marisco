<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Data pipeline (handler) to convert TEPCO dataset (Source) to NetCDF format">

<title>TEPCO – marisco</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-cd333c7267348b54b15a9ec2a617d176.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="TEPCO – marisco">
<meta property="og:description" content="Data pipeline (handler) to convert TEPCO dataset (Source) to NetCDF format">
<meta property="og:site_name" content="marisco">
<meta name="twitter:title" content="TEPCO – marisco">
<meta name="twitter:description" content="Data pipeline (handler) to convert TEPCO dataset (Source) to NetCDF format">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">marisco</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/franckalbinet/marisco"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../handlers/helcom.html">Handlers</a></li><li class="breadcrumb-item"><a href="../handlers/tepco.html">TEPCO</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MARISCO</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Handlers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../handlers/helcom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HELCOM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../handlers/ospar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OSPAR</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../handlers/geotraces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Geotraces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../handlers/maris_legacy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MARIS Legacy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../handlers/tepco.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">TEPCO</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">API</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/callbacks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Callbacks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/configs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Configs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/metadata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/encoders.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Encoders</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/decoders.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Decoders</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Utilities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/netcdf2csv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NetCDF2CSV</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Metadata</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../metadata/data-curation-rules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data curation rules</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../metadata/field-definition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Field definitions</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#configuration-file-paths" id="toc-configuration-file-paths" class="nav-link active" data-scroll-target="#configuration-file-paths">Configuration &amp; file paths</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load data</a>
  <ul>
  <li><a href="#find_location_section" id="toc-find_location_section" class="nav-link" data-scroll-target="#find_location_section">find_location_section</a></li>
  <li><a href="#fix_sampling_time" id="toc-fix_sampling_time" class="nav-link" data-scroll-target="#fix_sampling_time">fix_sampling_time</a></li>
  <li><a href="#get_coastal_water_df" id="toc-get_coastal_water_df" class="nav-link" data-scroll-target="#get_coastal_water_df">get_coastal_water_df</a></li>
  <li><a href="#get_locs_coastal_water" id="toc-get_locs_coastal_water" class="nav-link" data-scroll-target="#get_locs_coastal_water">get_locs_coastal_water</a></li>
  <li><a href="#get_clos1f_df" id="toc-get_clos1f_df" class="nav-link" data-scroll-target="#get_clos1f_df">get_clos1F_df</a></li>
  <li><a href="#get_locs_clos1f" id="toc-get_locs_clos1f" class="nav-link" data-scroll-target="#get_locs_clos1f">get_locs_clos1F</a></li>
  <li><a href="#get_locs_orbs" id="toc-get_locs_orbs" class="nav-link" data-scroll-target="#get_locs_orbs">get_locs_orbs</a></li>
  <li><a href="#concat_locs" id="toc-concat_locs" class="nav-link" data-scroll-target="#concat_locs">concat_locs</a></li>
  <li><a href="#align_dfs" id="toc-align_dfs" class="nav-link" data-scroll-target="#align_dfs">align_dfs</a></li>
  <li><a href="#concat_dfs" id="toc-concat_dfs" class="nav-link" data-scroll-target="#concat_dfs">concat_dfs</a></li>
  <li><a href="#georef_data" id="toc-georef_data" class="nav-link" data-scroll-target="#georef_data">georef_data</a></li>
  <li><a href="#load_data" id="toc-load_data" class="nav-link" data-scroll-target="#load_data">load_data</a></li>
  </ul></li>
  <li><a href="#remove-約-about-character" id="toc-remove-約-about-character" class="nav-link" data-scroll-target="#remove-約-about-character">Remove 約 (about) character</a>
  <ul>
  <li><a href="#removejapanasecharcb" id="toc-removejapanasecharcb" class="nav-link" data-scroll-target="#removejapanasecharcb">RemoveJapanaseCharCB</a></li>
  </ul></li>
  <li><a href="#fix-values-range-string" id="toc-fix-values-range-string" class="nav-link" data-scroll-target="#fix-values-range-string">Fix values range string</a>
  <ul>
  <li><a href="#fixrangevaluestringcb" id="toc-fixrangevaluestringcb" class="nav-link" data-scroll-target="#fixrangevaluestringcb">FixRangeValueStringCB</a></li>
  </ul></li>
  <li><a href="#select-columns-of-interest" id="toc-select-columns-of-interest" class="nav-link" data-scroll-target="#select-columns-of-interest">Select columns of interest</a>
  <ul>
  <li><a href="#selectcolsofinterestcb" id="toc-selectcolsofinterestcb" class="nav-link" data-scroll-target="#selectcolsofinterestcb">SelectColsOfInterestCB</a></li>
  </ul></li>
  <li><a href="#reshape-wide-to-long" id="toc-reshape-wide-to-long" class="nav-link" data-scroll-target="#reshape-wide-to-long">Reshape: wide to long</a>
  <ul>
  <li><a href="#widetolongcb" id="toc-widetolongcb" class="nav-link" data-scroll-target="#widetolongcb">WideToLongCB</a></li>
  </ul></li>
  <li><a href="#extract" id="toc-extract" class="nav-link" data-scroll-target="#extract">Extract</a>
  <ul>
  <li><a href="#nuclide-name" id="toc-nuclide-name" class="nav-link" data-scroll-target="#nuclide-name">Nuclide name</a></li>
  <li><a href="#extract_nuclide" id="toc-extract_nuclide" class="nav-link" data-scroll-target="#extract_nuclide">extract_nuclide</a></li>
  <li><a href="#extractnuclidenamecb" id="toc-extractnuclidenamecb" class="nav-link" data-scroll-target="#extractnuclidenamecb">ExtractNuclideNameCB</a></li>
  <li><a href="#unit" id="toc-unit" class="nav-link" data-scroll-target="#unit">Unit</a></li>
  <li><a href="#extractunitcb" id="toc-extractunitcb" class="nav-link" data-scroll-target="#extractunitcb">ExtractUnitCB</a></li>
  <li><a href="#value-type" id="toc-value-type" class="nav-link" data-scroll-target="#value-type">Value type</a></li>
  <li><a href="#extractvaluetypecb" id="toc-extractvaluetypecb" class="nav-link" data-scroll-target="#extractvaluetypecb">ExtractValueTypeCB</a></li>
  </ul></li>
  <li><a href="#reshape-long-to-wide" id="toc-reshape-long-to-wide" class="nav-link" data-scroll-target="#reshape-long-to-wide">Reshape: long to wide</a>
  <ul>
  <li><a href="#longtowidecb" id="toc-longtowidecb" class="nav-link" data-scroll-target="#longtowidecb">LongToWideCB</a></li>
  </ul></li>
  <li><a href="#remap-unit-name-to-maris-nomenclature" id="toc-remap-unit-name-to-maris-nomenclature" class="nav-link" data-scroll-target="#remap-unit-name-to-maris-nomenclature">Remap <code>UNIT</code> name to MARIS nomenclature</a>
  <ul>
  <li><a href="#remapunitnamecb" id="toc-remapunitnamecb" class="nav-link" data-scroll-target="#remapunitnamecb">RemapUnitNameCB</a></li>
  </ul></li>
  <li><a href="#remap-nuclide-name-to-maris-nomenclature" id="toc-remap-nuclide-name-to-maris-nomenclature" class="nav-link" data-scroll-target="#remap-nuclide-name-to-maris-nomenclature">Remap <code>NUCLIDE</code> name to MARIS nomenclature</a>
  <ul>
  <li><a href="#remapnuclidenamecb" id="toc-remapnuclidenamecb" class="nav-link" data-scroll-target="#remapnuclidenamecb">RemapNuclideNameCB</a></li>
  </ul></li>
  <li><a href="#remap-value-dl-dlv" id="toc-remap-value-dl-dlv" class="nav-link" data-scroll-target="#remap-value-dl-dlv">Remap <code>VALUE</code>, <code>DL</code>, <code>DLV</code></a>
  <ul>
  <li><a href="#remapvalue_dl_dlv_cb" id="toc-remapvalue_dl_dlv_cb" class="nav-link" data-scroll-target="#remapvalue_dl_dlv_cb">RemapVALUE_DL_DLV_CB</a></li>
  </ul></li>
  <li><a href="#convert-activity-to-bqm3" id="toc-convert-activity-to-bqm3" class="nav-link" data-scroll-target="#convert-activity-to-bqm3">Convert activity to <code>Bq/m3</code></a>
  <ul>
  <li><a href="#converttobqm3cb" id="toc-converttobqm3cb" class="nav-link" data-scroll-target="#converttobqm3cb">ConvertToBqM3CB</a></li>
  </ul></li>
  <li><a href="#parse-encode-time" id="toc-parse-encode-time" class="nav-link" data-scroll-target="#parse-encode-time">Parse &amp; encode time</a>
  <ul>
  <li><a href="#parsetimecb" id="toc-parsetimecb" class="nav-link" data-scroll-target="#parsetimecb">ParseTimeCB</a></li>
  </ul></li>
  <li><a href="#sanitize-coordinates" id="toc-sanitize-coordinates" class="nav-link" data-scroll-target="#sanitize-coordinates">Sanitize coordinates</a></li>
  <li><a href="#add-sample-id" id="toc-add-sample-id" class="nav-link" data-scroll-target="#add-sample-id">Add Sample ID</a>
  <ul>
  <li><a href="#addsampleidcb" id="toc-addsampleidcb" class="nav-link" data-scroll-target="#addsampleidcb">AddSampleIdCB</a></li>
  </ul></li>
  <li><a href="#encode-to-netcdf" id="toc-encode-to-netcdf" class="nav-link" data-scroll-target="#encode-to-netcdf">Encode to NetCDF</a>
  <ul>
  <li><a href="#get_attrs" id="toc-get_attrs" class="nav-link" data-scroll-target="#get_attrs">get_attrs</a></li>
  <li><a href="#encode" id="toc-encode" class="nav-link" data-scroll-target="#encode">encode</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/franckalbinet/marisco/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../handlers/helcom.html">Handlers</a></li><li class="breadcrumb-item"><a href="../handlers/tepco.html">TEPCO</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">TEPCO</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li></ul></div></div>
</div>

<div>
  <div class="description">
    Data pipeline (handler) to convert TEPCO dataset (<a href="https://radioactivity.nsr.go.jp/ja/list/349/list-1.html">Source</a>) to <code>NetCDF</code> format
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="configuration-file-paths" class="level2">
<h2 class="anchored" data-anchor-id="configuration-file-paths">Configuration &amp; file paths</h2>
<div id="7969707f-98cb-4d7c-9d0a-47f7408d5098" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>fname_coastal_water <span class="op">=</span> <span class="st">'https://radioactivity.nra.go.jp/cont/en/results/sea/coastal_water.csv'</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>fname_clos1F <span class="op">=</span> <span class="st">'https://radioactivity.nra.go.jp/cont/en/results/sea/close1F_water.xlsx'</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>fname_iaea_orbs <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/RML-IAEA/iaea.orbs/refs/heads/main/src/iaea/orbs/stations/station_points.csv'</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>fname_out <span class="op">=</span> <span class="st">'../../_data/output/tepco.nc'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load data</h2>
<p>We here load the data from the <a href="https://radioactivity.nra.go.jp/en/results">NRA (Nuclear Regulatory Authority)</a> website. For the moment, we only process radioactivity concentration data in the seawater around Fukushima Dai-ichi NPP [TEPCO] (<code>coastal_water.csv</code>) and in the <code>close1F_water.xlsx</code> file.</p>
<p>In near future, MARIS will provide a dedicated handler for all related <a href="https://radioactivity.nra.go.jp/en/results#sec-12">ALPS data</a> including measurements not only provided by TEPCO but also MOE, NRA, MLITT and Fukushima Prefecture.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>FEEDBACK TO DATA PROVIDER
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <strong>coastal_water.csv</strong> file contains two sections: the measurements and the locations. We identify below the line number where the locations begin. A single point of truth for the location of the stations would ease the processing in future.</p>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L55" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="find_location_section" class="level3">
<h3 class="anchored" data-anchor-id="find_location_section">find_location_section</h3>
<blockquote class="blockquote">
<pre><code> find_location_section (df, col_idx=0, pattern='Sampling point number')</code></pre>
</blockquote>
<p><em>Find the line number where location data begins.</em></p>
<div id="8940a774" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_location_section(df, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                          col_idx<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                          pattern<span class="op">=</span><span class="st">'Sampling point number'</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                          ):</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Find the line number where location data begins."</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> df.iloc[:, col_idx] <span class="op">==</span> pattern</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    indices <span class="op">=</span> df[mask].index</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> indices[<span class="dv">0</span>] <span class="cf">if</span> <span class="bu">len</span>(indices) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="4cac8d83" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>find_location_section(pd.read_csv(fname_coastal_water, low_memory<span class="op">=</span><span class="va">False</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>np.int64(29252)</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>FEEDBACK TO DATA PROVIDER
</div>
</div>
<div class="callout-body-container callout-body">
<p>Distinct parsing of the time from <code>coastal_water.csv</code> and <code>close1F_water.xlsx</code> files are required. Indeed:</p>
<ul>
<li><code>coastal_water.csv</code> uses the format <code>YYYY/MM/DD</code> in the <code>Sampling  HH:MM</code> and</li>
<li><code>close1F_water.xlsx</code> uses the format <code>YYYY-MM-DD HH:MM:SS</code>.</li>
</ul>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L65" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="fix_sampling_time" class="level3">
<h3 class="anchored" data-anchor-id="fix_sampling_time">fix_sampling_time</h3>
<blockquote class="blockquote">
<pre><code> fix_sampling_time (x)</code></pre>
</blockquote>
<div id="a6c4b970" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fix_sampling_time(x):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isna(x): </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'00:00:00'</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        hour, <span class="bu">min</span> <span class="op">=</span>  x.split(<span class="st">':'</span>)[:<span class="dv">2</span>]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>hour <span class="cf">if</span> <span class="bu">len</span>(hour) <span class="op">==</span> <span class="dv">2</span> <span class="cf">else</span> <span class="st">'0'</span> <span class="op">+</span> hour<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span><span class="bu">min</span><span class="sc">}</span><span class="ss">:00"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L73" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_coastal_water_df" class="level3">
<h3 class="anchored" data-anchor-id="get_coastal_water_df">get_coastal_water_df</h3>
<blockquote class="blockquote">
<pre><code> get_coastal_water_df (fname_coastal_water)</code></pre>
</blockquote>
<p><em>Get the measurements dataframe from the <code>coastal_water.csv</code> file.</em></p>
<div id="ea728c3b" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_coastal_water_df(fname_coastal_water):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Get the measurements dataframe from the `coastal_water.csv` file."</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    locs_idx <span class="op">=</span> find_location_section(pd.read_csv(fname_coastal_water, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                                      skiprows<span class="op">=</span><span class="dv">0</span>, low_memory<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_csv(fname_coastal_water, skiprows<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                     nrows<span class="op">=</span>locs_idx <span class="op">-</span> <span class="dv">1</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                     low_memory<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    df.dropna(subset<span class="op">=</span>[<span class="st">'Sampling point number'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Sampling time'</span>] <span class="op">=</span> df[<span class="st">'Sampling time'</span>].<span class="bu">map</span>(fix_sampling_time)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'TIME'</span>] <span class="op">=</span> df[<span class="st">'Sampling date'</span>].replace(<span class="st">'-'</span>, <span class="st">'/'</span>) <span class="op">+</span> <span class="st">' '</span> <span class="op">+</span> df[<span class="st">'Sampling time'</span>]</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">'Sampling date'</span>, <span class="st">'Sampling time'</span>])</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="29da7516" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df_coastal_water <span class="op">=</span> get_coastal_water_df(fname_coastal_water)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df_coastal_water.tail()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sampling point number</th>
<th data-quarto-table-cell-role="th">Collection layer of seawater</th>
<th data-quarto-table-cell-role="th">131I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">131I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">54Mn radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">54Mn detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">3H radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">3H detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">125Sb radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">125Sb detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">Unnamed: 49</th>
<th data-quarto-table-cell-role="th">TIME</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">29219</th>
<td>T-D5</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>6.2E+00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2025/7/17 07:56:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">29220</th>
<td>T-S8</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>6.8E+00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2025/7/18 05:34:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">29221</th>
<td>T-D5</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>7.9E+00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2025/7/21 08:05:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">29222</th>
<td>T-S3</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>7.3E+00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2025/7/22 05:54:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">29223</th>
<td>T-S4</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>7.4E+00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2025/7/22 06:17:00</td>
</tr>
</tbody>
</table>

<p>5 rows × 49 columns</p>
</div>
</div>
</div>
<div id="bd25f055" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>coi <span class="op">=</span> [o <span class="cf">for</span> o <span class="kw">in</span> df_coastal_water.columns <span class="cf">if</span> <span class="st">"134Cs"</span> <span class="kw">in</span> o]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>df_coastal_water[coi <span class="op">+</span> [<span class="st">'Sampling point number'</span>, <span class="st">'TIME'</span>]].head(<span class="dv">30</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">134Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">Sampling point number</th>
<th data-quarto-table-cell-role="th">TIME</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>4.8E+01</td>
<td>9.2E+00</td>
<td>T-3</td>
<td>2011/3/21 23:15:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>3.1E+01</td>
<td>8.7E+00</td>
<td>T-4</td>
<td>2011/3/21 23:45:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>4.6E+01</td>
<td>1.4E+01</td>
<td>T-3</td>
<td>2011/3/22 14:28:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>3.9E+01</td>
<td>1.1E+01</td>
<td>T-4</td>
<td>2011/3/22 15:06:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>5.1E+01</td>
<td>2.0E+01</td>
<td>T-3</td>
<td>2011/3/23 13:51:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>3.3E+01</td>
<td>2.1E+01</td>
<td>T-4</td>
<td>2011/3/23 14:25:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>9.9E+01</td>
<td>3.8E+01</td>
<td>T-3</td>
<td>2011/3/24 09:30:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>3.5E+01</td>
<td>7.0E+00</td>
<td>T-4</td>
<td>2011/3/24 08:45:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>2.6E+01</td>
<td>7.4E+00</td>
<td>T-3</td>
<td>2011/3/25 10:00:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>2.0E+01</td>
<td>6.7E+00</td>
<td>T-4</td>
<td>2011/3/25 09:10:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>2.6E+01</td>
<td>1.8E+01</td>
<td>T-3</td>
<td>2011/3/26 15:15:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>1.3E+01</td>
<td>7.1E+00</td>
<td>T-4</td>
<td>2011/3/26 15:50:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">12</th>
<td>5.4E+02</td>
<td>1.2E+01</td>
<td>T-3</td>
<td>2011/3/27 14:30:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">13</th>
<td>2.0E+01</td>
<td>6.0E+00</td>
<td>T-4</td>
<td>2011/3/27 08:45:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14</th>
<td>6.1E+02</td>
<td>2.3E+01</td>
<td>T-3</td>
<td>2011/3/28 09:35:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">15</th>
<td>3.3E+02</td>
<td>2.1E+01</td>
<td>T-4</td>
<td>2011/3/28 08:45:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16</th>
<td>3.2E+02</td>
<td>1.3E+01</td>
<td>T-3</td>
<td>2011/3/29 10:15:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">17</th>
<td>2.3E+02</td>
<td>1.2E+01</td>
<td>T-4</td>
<td>2011/3/29 09:20:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">18</th>
<td>3.6E+02</td>
<td>2.0E+01</td>
<td>T-3</td>
<td>2011/3/30 10:00:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">19</th>
<td>1.8E+02</td>
<td>2.0E+01</td>
<td>T-4</td>
<td>2011/3/30 09:05:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">20</th>
<td>3.6E+02</td>
<td>2.1E+01</td>
<td>T-3</td>
<td>2011/3/31 10:00:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">21</th>
<td>1.6E+02</td>
<td>2.0E+01</td>
<td>T-4</td>
<td>2011/3/31 09:15:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">22</th>
<td>3.0E+02</td>
<td>1.8E+01</td>
<td>T-3</td>
<td>2011/4/1 09:50:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">23</th>
<td>2.0E+02</td>
<td>1.8E+01</td>
<td>T-4</td>
<td>2011/4/1 09:00:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">24</th>
<td>1.9E+01</td>
<td>1.5E+01</td>
<td>8</td>
<td>2011/4/2 13:35:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">25</th>
<td>1.7E+02</td>
<td>1.7E+01</td>
<td>T-3</td>
<td>2011/4/2 09:55:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">26</th>
<td>5.1E+01</td>
<td>1.7E+01</td>
<td>T-4</td>
<td>2011/4/2 09:00:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">27</th>
<td>2.3E+01</td>
<td>4.9E+00</td>
<td>T-5</td>
<td>2011/4/2 14:03:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">28</th>
<td>NaN</td>
<td>NaN</td>
<td>T-7</td>
<td>2011/4/2 13:12:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">29</th>
<td>NaN</td>
<td>NaN</td>
<td>8</td>
<td>2011/4/3 12:20:00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="83bb160a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>coi</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>['134Cs radioactivity concentration (Bq/L)', '134Cs detection limit (Bq/L)']</code></pre>
</div>
</div>
<div id="23735681" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df_coastal_water.dropna(subset<span class="op">=</span>coi, how<span class="op">=</span><span class="st">'any'</span>)[coi <span class="op">+</span> [<span class="st">'Sampling point number'</span>, <span class="st">'TIME'</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">134Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">Sampling point number</th>
<th data-quarto-table-cell-role="th">TIME</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>4.8E+01</td>
<td>9.2E+00</td>
<td>T-3</td>
<td>2011/3/21 23:15:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>3.1E+01</td>
<td>8.7E+00</td>
<td>T-4</td>
<td>2011/3/21 23:45:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>4.6E+01</td>
<td>1.4E+01</td>
<td>T-3</td>
<td>2011/3/22 14:28:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>3.9E+01</td>
<td>1.1E+01</td>
<td>T-4</td>
<td>2011/3/22 15:06:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>5.1E+01</td>
<td>2.0E+01</td>
<td>T-3</td>
<td>2011/3/23 13:51:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">29209</th>
<td>ND</td>
<td>1.1E-03</td>
<td>T-11</td>
<td>2025/6/27 09:41:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">29210</th>
<td>ND</td>
<td>1.3E-03</td>
<td>T-5</td>
<td>2025/6/27 08:09:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">29211</th>
<td>ND</td>
<td>1.2E-03</td>
<td>T-5</td>
<td>2025/6/27 08:09:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">29212</th>
<td>ND</td>
<td>1.1E-03</td>
<td>T-D9</td>
<td>2025/6/27 09:03:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">29213</th>
<td>ND</td>
<td>1.0E-03</td>
<td>T-D9</td>
<td>2025/6/27 09:03:00</td>
</tr>
</tbody>
</table>

<p>19128 rows × 4 columns</p>
</div>
</div>
</div>
<div id="a446b09a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> df_coastal_water[<span class="st">'134Cs radioactivity concentration (Bq/L)'</span>] <span class="op">==</span> <span class="st">'ND'</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df_coastal_water[mask][coi <span class="op">+</span> [<span class="st">'Sampling point number'</span>, <span class="st">'TIME'</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">134Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">Sampling point number</th>
<th data-quarto-table-cell-role="th">TIME</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">53</th>
<td>ND</td>
<td>NaN</td>
<td>5</td>
<td>2011/4/6 11:30:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">57</th>
<td>ND</td>
<td>NaN</td>
<td>8</td>
<td>2011/4/6 12:52:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">59</th>
<td>ND</td>
<td>NaN</td>
<td>10</td>
<td>2011/4/6 13:37:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">64</th>
<td>ND</td>
<td>NaN</td>
<td>T-7</td>
<td>2011/4/6 12:44:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">65</th>
<td>ND</td>
<td>NaN</td>
<td>T-7</td>
<td>2011/4/6 13:15:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">29209</th>
<td>ND</td>
<td>1.1E-03</td>
<td>T-11</td>
<td>2025/6/27 09:41:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">29210</th>
<td>ND</td>
<td>1.3E-03</td>
<td>T-5</td>
<td>2025/6/27 08:09:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">29211</th>
<td>ND</td>
<td>1.2E-03</td>
<td>T-5</td>
<td>2025/6/27 08:09:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">29212</th>
<td>ND</td>
<td>1.1E-03</td>
<td>T-D9</td>
<td>2025/6/27 09:03:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">29213</th>
<td>ND</td>
<td>1.0E-03</td>
<td>T-D9</td>
<td>2025/6/27 09:03:00</td>
</tr>
</tbody>
</table>

<p>19215 rows × 4 columns</p>
</div>
</div>
</div>
<div id="2fa3d8ee" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(df_coastal_water)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>29224</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>FEEDBACK TO DATA PROVIDER
</div>
</div>
<div class="callout-body-container callout-body">
<p>Identification of the stations location requires three distinct files:</p>
<ul>
<li>the second section of the <code>coastal_water.csv</code> file</li>
<li>the <code>R6zahyo.pdf</code> file further processed by <a href="https://github.com/RML-IAEA/iaea.orbs">https://github.com/RML-IAEA/iaea.orbs</a></li>
<li>the second sections of all sheets of <code>close1F_water.xlsx</code> file</li>
</ul>
<p>All files and sheets required to look up the location of the stations.</p>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L91" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_locs_coastal_water" class="level3">
<h3 class="anchored" data-anchor-id="get_locs_coastal_water">get_locs_coastal_water</h3>
<blockquote class="blockquote">
<pre><code> get_locs_coastal_water (fname_coastal_water)</code></pre>
</blockquote>
<div id="fe30cf4f" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_locs_coastal_water(fname_coastal_water):</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    locs_idx <span class="op">=</span> find_location_section(pd.read_csv(fname_coastal_water, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                                      skiprows<span class="op">=</span><span class="dv">0</span>, low_memory<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_csv(fname_coastal_water, skiprows<span class="op">=</span>locs_idx<span class="op">+</span><span class="dv">1</span>, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                     low_memory<span class="op">=</span><span class="va">False</span>).iloc[:, :<span class="dv">3</span>]</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    df.columns <span class="op">=</span> [<span class="st">'STATION'</span>, <span class="st">'LON'</span>, <span class="st">'LAT'</span>]</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    df.dropna(subset<span class="op">=</span>[<span class="st">'LAT'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'org'</span>] <span class="op">=</span> <span class="st">'coastal_seawater.csv'</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="93428343" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df_locs_coastal_water <span class="op">=</span> get_locs_coastal_water(fname_coastal_water)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Nb. of stations: </span><span class="sc">{</span><span class="bu">len</span>(df_locs_coastal_water)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>df_locs_coastal_water.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Nb. of stations: 48</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">org</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>T-0</td>
<td>37.42</td>
<td>141.04</td>
<td>coastal_seawater.csv</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>T-11</td>
<td>37.24</td>
<td>141.05</td>
<td>coastal_seawater.csv</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>T-12</td>
<td>37.15</td>
<td>141.04</td>
<td>coastal_seawater.csv</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>T-13-1</td>
<td>37.64</td>
<td>141.04</td>
<td>coastal_seawater.csv</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>T-14</td>
<td>37.55</td>
<td>141.06</td>
<td>coastal_seawater.csv</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="0ec17317" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df_locs_coastal_water.STATION.unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>array(['T-0', 'T-11', 'T-12', 'T-13-1', 'T-14', 'T-17-1', 'T-18', 'T-20',
       'T-22', 'T-3', 'T-4', 'T-4-1', 'T-4-2', 'T-5', 'T-6', 'T-7', 'T-A',
       'T-B', 'T-B1', 'T-B2', 'T-B3', 'T-B4', 'T-C', 'T-D', 'T-D1',
       'T-D5', 'T-D9', 'T-E', 'T-E1', 'T-Z', 'T-MG6', 'T-S1', 'T-S7',
       'T-H1', 'T-S2', 'T-S6', 'T-M10', 'T-MA', 'T-S3', 'T-S4', 'T-S8',
       'T-MG4', 'T-G4', 'T-MG5', 'T-MG1', 'T-MG0', 'T-MG3', 'T-MG2'],
      dtype=object)</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>FEEDBACK TO DATA PROVIDER
</div>
</div>
<div class="callout-body-container callout-body">
<p>Data contained in the <code>close1F_water.xlsx</code> file are spread in several sheets (one per station). Each sheet further contains two sections: the measurements and the locations.</p>
<p>For each sheet, we have to identify the line number where to split both measurements and the location. We then need to further iterate over all sheets to concatenate the results.</p>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L104" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_clos1f_df" class="level3">
<h3 class="anchored" data-anchor-id="get_clos1f_df">get_clos1F_df</h3>
<blockquote class="blockquote">
<pre><code> get_clos1F_df (fname_clos1F)</code></pre>
</blockquote>
<p><em>Get measurements dataframe from close1F_water.xlsx file and parse datetime.</em></p>
<div id="78695232" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_clos1F_df(fname_clos1F):</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Get measurements dataframe from close1F_water.xlsx file and parse datetime."</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    excel_file <span class="op">=</span> pd.ExcelFile(fname_clos1F)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    dfs <span class="op">=</span> {}</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sheet_name <span class="kw">in</span> tqdm(excel_file.sheet_names):</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        locs_idx <span class="op">=</span> find_location_section(pd.read_excel(excel_file, </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                                                       sheet_name<span class="op">=</span>sheet_name,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>                                                       skiprows<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.read_excel(excel_file, </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>                   sheet_name<span class="op">=</span>sheet_name, </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                   skiprows<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>                   nrows<span class="op">=</span>locs_idx<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>        df.dropna(subset<span class="op">=</span>[<span class="st">'Sampling point number'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'Sampling date'</span>] <span class="op">=</span> df[<span class="st">'Sampling date'</span>]<span class="op">\</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>            .astype(<span class="bu">str</span>)<span class="op">\</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>            .<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.split(<span class="st">' '</span>)[<span class="dv">0</span>]<span class="op">\</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>            .replace(<span class="st">'-'</span>, <span class="st">'/'</span>))</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>        dfs[sheet_name] <span class="op">=</span> df</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.concat(dfs.values(), ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    df.dropna(subset<span class="op">=</span>[<span class="st">'Sampling date'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'TIME'</span>] <span class="op">=</span> df[<span class="st">'Sampling date'</span>] <span class="op">+</span> <span class="st">' '</span> <span class="op">+</span> df[<span class="st">'Sampling time'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">'Sampling date'</span>, <span class="st">'Sampling time'</span>])</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="f17065f2" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df_clos1F <span class="op">=</span> get_clos1F_df(fname_clos1F)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>df_clos1F.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 11/11 [00:05&lt;00:00,  2.17it/s]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sampling point number</th>
<th data-quarto-table-cell-role="th">134Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">Total beta radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">Total beta detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">3H radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">3H detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">Collection layer of seawater</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">106Ru detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">60Co radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">60Co detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">95Zr radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">95Zr detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">99Mo radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">99Mo detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">TIME</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>T-0-1</td>
<td>ND</td>
<td>1.5</td>
<td>ND</td>
<td>1.4</td>
<td>ND</td>
<td>18.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2013/08/14 08:17:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>T-0-1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>4.7</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2013/08/14 08:17:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>T-0-1</td>
<td>ND</td>
<td>1.1</td>
<td>ND</td>
<td>1.4</td>
<td>ND</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2013/08/21 08:09:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>T-0-1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>2.9</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2013/08/21 08:09:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>T-0-1</td>
<td>ND</td>
<td>0.66</td>
<td>ND</td>
<td>0.49</td>
<td>ND</td>
<td>17.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2013/08/27 08:14:00</td>
</tr>
</tbody>
</table>

<p>5 rows × 57 columns</p>
</div>
</div>
</div>
<div id="152b6bde" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df_clos1F[<span class="st">'Sampling point number'</span>].unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>array(['T-0-1', 'T-0-1A', 'T-0-2', 'T-0-3', 'T-0-3A', 'T-1', 'T-2',
       'T-2-1', 'T-A1', 'T-A2', 'T-A3'], dtype=object)</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L133" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_locs_clos1f" class="level3">
<h3 class="anchored" data-anchor-id="get_locs_clos1f">get_locs_clos1F</h3>
<blockquote class="blockquote">
<pre><code> get_locs_clos1F (fname_clos1F)</code></pre>
</blockquote>
<p><em>Get locations dataframe from close1F_water.xlsx file from each sheets.</em></p>
<div id="354969c8" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_locs_clos1F(fname_clos1F):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Get locations dataframe from close1F_water.xlsx file from each sheets."</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    excel_file <span class="op">=</span> pd.ExcelFile(fname_clos1F)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    dfs <span class="op">=</span> {}</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sheet_name <span class="kw">in</span> tqdm(excel_file.sheet_names):</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        locs_idx <span class="op">=</span> find_location_section(pd.read_excel(excel_file, </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>                                                       sheet_name<span class="op">=</span>sheet_name,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                                                       skiprows<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.read_excel(excel_file, </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>                           sheet_name<span class="op">=</span>sheet_name, </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                           skiprows<span class="op">=</span>locs_idx<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        dfs[sheet_name] <span class="op">=</span> df</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.concat(dfs.values(), ignore_index<span class="op">=</span><span class="va">True</span>).iloc[:, :<span class="dv">3</span>]</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    df.dropna(subset<span class="op">=</span>[<span class="st">'Sampling coordinate North latitude (Decimal)'</span>], inplace<span class="op">=</span><span class="va">True</span>)    </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    df.columns <span class="op">=</span> [<span class="st">'STATION'</span>, <span class="st">'LON'</span>, <span class="st">'LAT'</span>]</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'org'</span>] <span class="op">=</span> <span class="st">'close1F.csv'</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="58923905" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df_locs_clos1F <span class="op">=</span> get_locs_clos1F(fname_clos1F)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Nb. of stations: </span><span class="sc">{</span><span class="bu">len</span>(df_locs_clos1F)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>df_locs_clos1F.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 11/11 [00:05&lt;00:00,  1.97it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Nb. of stations: 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">org</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>T-0-1</td>
<td>37.43</td>
<td>141.04</td>
<td>close1F.csv</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>T-0-1A</td>
<td>37.43</td>
<td>141.05</td>
<td>close1F.csv</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">22</th>
<td>T-0-2</td>
<td>37.42</td>
<td>141.05</td>
<td>close1F.csv</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">33</th>
<td>T-0-3</td>
<td>37.42</td>
<td>141.04</td>
<td>close1F.csv</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">44</th>
<td>T-0-3A</td>
<td>37.42</td>
<td>141.05</td>
<td>close1F.csv</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>FEEDBACK TO DATA PROVIDER
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>close1F_water.xlsx</code> file contains station locations that are not present in the <code>coastal_water.csv</code> dataset, as demonstrated in the comparison below:</p>
</div>
</div>
<div id="51330348" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>(df_locs_clos1F.STATION) <span class="op">-</span> <span class="bu">set</span>(df_locs_coastal_water.STATION)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>{'T-0-1',
 'T-0-1A',
 'T-0-2',
 'T-0-3',
 'T-0-3A',
 'T-1',
 'T-2',
 'T-2-1',
 'T-A1',
 'T-A2',
 'T-A3'}</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>FEEDBACK TO DATA PROVIDER
</div>
</div>
<div class="callout-body-container callout-body">
<p>In theory all locations are supposed to be provided in the <a href="https://radioactivity.nra.go.jp/cont/en/results/sea/R6zahyo.pdf">R6zahyo.pdf</a> file. This file is further processed by https://github.com/RML-IAEA/iaea.orbs and the result is provided in the <code>station_points.csv</code> file.</p>
<p>However, this file lacks complete coverage of locations referenced in both <code>coastal_water.csv</code> and <code>close1F_water.xlsx</code> files, while simultaneously containing additional locations not present in either (see below). A more standardized and comprehensive location reference system would significantly improve the efficiency and reliability of the data ingestion process.</p>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L155" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_locs_orbs" class="level3">
<h3 class="anchored" data-anchor-id="get_locs_orbs">get_locs_orbs</h3>
<blockquote class="blockquote">
<pre><code> get_locs_orbs (fname_iaea_orbs)</code></pre>
</blockquote>
<div id="6a5b3732" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_locs_orbs(fname_iaea_orbs):</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_csv(fname_iaea_orbs)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    df.columns <span class="op">=</span> [<span class="st">'org'</span>, <span class="st">'STATION'</span>, <span class="st">'LON'</span>, <span class="st">'LAT'</span>]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="c2a84651" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>df_locs_orbs <span class="op">=</span> get_locs_orbs(fname_iaea_orbs)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>df_locs_orbs.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">org</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>MOE</td>
<td>E-31</td>
<td>141.727667</td>
<td>39.059167</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>MOE</td>
<td>E-32</td>
<td>141.635667</td>
<td>38.996000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>MOE</td>
<td>E-37</td>
<td>141.948611</td>
<td>39.259167</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>MOE</td>
<td>E-38</td>
<td>141.755000</td>
<td>39.008333</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>MOE</td>
<td>E-39</td>
<td>141.766667</td>
<td>38.991667</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="38fd2e41" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>(df_locs_orbs.STATION) <span class="op">-</span> (<span class="bu">set</span>(df_locs_clos1F.STATION) <span class="op">|</span> <span class="bu">set</span>(df_locs_coastal_water.STATION))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>{'C-P1',
 'C-P2',
 'C-P3',
 'C-P4',
 'C-P5',
 'C-P8',
 'E-31',
 'E-32',
 'E-37',
 'E-38',
 'E-39',
 'E-3A',
 'E-41',
 'E-42',
 'E-43',
 'E-44',
 'E-45',
 'E-46',
 'E-47',
 'E-48',
 'E-49',
 'E-4A',
 'E-4B',
 'E-4C',
 'E-4F',
 'E-4G',
 'E-4H',
 'E-4J',
 'E-4K',
 'E-4L',
 'E-4M',
 'E-71',
 'E-72',
 'E-73',
 'E-74',
 'E-75',
 'E-76',
 'E-77',
 'E-78',
 'E-79',
 'E-7A',
 'E-7B',
 'E-7C',
 'E-7D',
 'E-7F',
 'E-7G',
 'E-7H',
 'E-7I',
 'E-7J',
 'E-7K',
 'E-7L',
 'E-81',
 'E-82',
 'E-83',
 'E-84',
 'E-85',
 'E-S1',
 'E-S10',
 'E-S13',
 'E-S14',
 'E-S15',
 'E-S17',
 'E-S18',
 'E-S19',
 'E-S20',
 'E-S21',
 'E-S22',
 'E-S23',
 'E-S24',
 'E-S25',
 'E-S26',
 'E-S27',
 'E-S28',
 'E-S29',
 'E-S3',
 'E-S30',
 'E-S31',
 'E-S32',
 'E-S33',
 'E-S34',
 'E-S35',
 'E-S36',
 'E-S4',
 'E-S5',
 'E-T1',
 'E-T2',
 'E-T3',
 'E-T4',
 'E-T5',
 'E-T6',
 'E-T7',
 'E-T8',
 'F-P01',
 'F-P02',
 'F-P03',
 'F-P04',
 'F-P05',
 'F-P06',
 'F-P07',
 'F-P08',
 'F-P09',
 'F-P10',
 'F-P11',
 'F-P12',
 'F-P13',
 'F-P14',
 'F-P15',
 'F-P29',
 'F-P30',
 'F-P31',
 'F-P32',
 'F-P33',
 'F-P34',
 'F-P35',
 'F-P37',
 'F-P38',
 'F-P39',
 'F-P40',
 'F-P41',
 'F-P42',
 'F-P43',
 'F-P45',
 'F-P46',
 'F-P47',
 'F-P48',
 'F-P49',
 'F-P50',
 'F-P51',
 'F-P52',
 'F-P53',
 'F-P54',
 'F-P55',
 'F-P56',
 'F-P57',
 'F-P58',
 'F-P59',
 'F-P60',
 'F-P61',
 'F-P62',
 'F-P63',
 'F-P64',
 'F-P65',
 'F-P66',
 'F-P67',
 'F-P68',
 'F-P69',
 'F-P70',
 'F-P71',
 'F-P72',
 'F-P73',
 'F-P74',
 'F-P75',
 'F-P76',
 'F-P77',
 'F-P78',
 'F-P79',
 'F-P80',
 'F-P81',
 'F-P82',
 'F-P83',
 'K-T1',
 'K-T2',
 'KK-U1',
 'M-10',
 'M-101',
 'M-102',
 'M-103',
 'M-104',
 'M-11',
 'M-14',
 'M-15',
 'M-19',
 'M-20',
 'M-21',
 'M-25',
 'M-26',
 'M-27',
 'M-A1',
 'M-A3',
 'M-B1',
 'M-B5',
 'M-C1',
 'M-C10',
 'M-C2',
 'M-C3',
 'M-C4',
 'M-C6',
 'M-C7',
 'M-C8',
 'M-C9',
 'M-D1',
 'M-D3',
 'M-E1',
 'M-E3',
 'M-E5',
 'M-F1',
 'M-F3',
 'M-G0',
 'M-G1',
 'M-G3',
 'M-G4',
 'M-H1',
 'M-H3',
 'M-I0',
 'M-I1',
 'M-I3',
 'M-IB2',
 'M-IB4',
 'M-J1',
 'M-J3',
 'M-K1',
 'M-L1',
 'M-L3',
 'M-M1',
 'M-MI4',
 'T-S5',
 'T-①',
 'T-②',
 'T-③',
 'T-④',
 'T-⑤',
 'T-⑥',
 'T-⑦',
 'T-⑧',
 'T-⑨',
 'T-⑩',
 'T-⑪',
 'T-⑫',
 'T-⑬'}</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L161" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="concat_locs" class="level3">
<h3 class="anchored" data-anchor-id="concat_locs">concat_locs</h3>
<blockquote class="blockquote">
<pre><code> concat_locs (dfs)</code></pre>
</blockquote>
<p><em>Concatenate and drop duplicates from coastal_seawater.csv and iaea_orbs.csv (kept)</em></p>
<div id="31e1034a" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> concat_locs(dfs):</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Concatenate and drop duplicates from coastal_seawater.csv and iaea_orbs.csv (kept)"</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.concat(dfs)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Group by org to be used for sorting</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'org_grp'</span>] <span class="op">=</span> df[<span class="st">'org'</span>].<span class="bu">apply</span>(</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x <span class="op">==</span> <span class="st">'coastal_seawater.csv'</span> <span class="cf">else</span> <span class="dv">2</span> <span class="cf">if</span> x <span class="op">==</span> <span class="st">'close1F.csv'</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    df.sort_values(<span class="st">'org_grp'</span>, ascending<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Drop duplicates and keep orbs data first</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    df.drop_duplicates(subset<span class="op">=</span><span class="st">'STATION'</span>, keep<span class="op">=</span><span class="st">'first'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    df.drop(columns<span class="op">=</span>[<span class="st">'org_grp'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    df.sort_values(<span class="st">'STATION'</span>, ascending<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="0f4efd46" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df_locs <span class="op">=</span> concat_locs([df_locs_clos1F, df_locs_coastal_water, df_locs_orbs])</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>df_locs.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">org</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">214</th>
<td>C-P1</td>
<td>139.863333</td>
<td>35.425000</td>
<td>NRA</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">215</th>
<td>C-P2</td>
<td>139.863333</td>
<td>35.401667</td>
<td>NRA</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">216</th>
<td>C-P3</td>
<td>139.881667</td>
<td>35.370000</td>
<td>NRA</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">217</th>
<td>C-P4</td>
<td>139.846667</td>
<td>35.356667</td>
<td>NRA</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">218</th>
<td>C-P5</td>
<td>139.800000</td>
<td>35.343333</td>
<td>NRA</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L175" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="align_dfs" class="level3">
<h3 class="anchored" data-anchor-id="align_dfs">align_dfs</h3>
<blockquote class="blockquote">
<pre><code> align_dfs (df_from, df_to)</code></pre>
</blockquote>
<p><em>Align columns structure of df_from to df_to.</em></p>
<div id="92ee3dc5" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> align_dfs(df_from, df_to):</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Align columns structure of df_from to df_to."</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> defaultdict()    </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> df_to.columns:</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>        df[c] <span class="op">=</span> df_from[c].values <span class="cf">if</span> c <span class="kw">in</span> df_from.columns <span class="cf">else</span> np.nan</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="5761ba38" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>align_dfs(df_clos1F, df_coastal_water).head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sampling point number</th>
<th data-quarto-table-cell-role="th">Collection layer of seawater</th>
<th data-quarto-table-cell-role="th">131I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">131I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">54Mn radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">54Mn detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">3H radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">3H detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">125Sb radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">125Sb detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">Unnamed: 49</th>
<th data-quarto-table-cell-role="th">TIME</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>T-0-1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>1.5</td>
<td>ND</td>
<td>1.4</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2013/08/14 08:17:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>T-0-1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>4.7</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2013/08/14 08:17:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>T-0-1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>1.1</td>
<td>ND</td>
<td>1.4</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2013/08/21 08:09:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>T-0-1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>2.9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2013/08/21 08:09:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>T-0-1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>0.66</td>
<td>ND</td>
<td>0.49</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2013/08/27 08:14:00</td>
</tr>
</tbody>
</table>

<p>5 rows × 49 columns</p>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L183" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="concat_dfs" class="level3">
<h3 class="anchored" data-anchor-id="concat_dfs">concat_dfs</h3>
<blockquote class="blockquote">
<pre><code> concat_dfs (df_coastal_water, df_clos1F)</code></pre>
</blockquote>
<p><em>Concatenate and drop duplicates from coastal_seawater.csv and close1F_water.xlsx (kept)</em></p>
<div id="49340aa4" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> concat_dfs(df_coastal_water, df_clos1F):</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Concatenate and drop duplicates from coastal_seawater.csv and close1F_water.xlsx (kept)"</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    df_clos1F <span class="op">=</span> align_dfs(df_clos1F, df_coastal_water)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.concat([df_coastal_water, df_clos1F])</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="99cce628" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>df_meas <span class="op">=</span> concat_dfs(df_coastal_water, df_clos1F)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>df_meas.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sampling point number</th>
<th data-quarto-table-cell-role="th">Collection layer of seawater</th>
<th data-quarto-table-cell-role="th">131I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">131I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">54Mn radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">54Mn detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">3H radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">3H detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">125Sb radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">125Sb detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">Unnamed: 49</th>
<th data-quarto-table-cell-role="th">TIME</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>T-3</td>
<td>NaN</td>
<td>1.1E+03</td>
<td>1.3E+01</td>
<td>4.8E+01</td>
<td>9.2E+00</td>
<td>5.3E+01</td>
<td>8.8E+00</td>
<td>1.6E+02</td>
<td>44.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/21 23:15:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>T-4</td>
<td>NaN</td>
<td>6.6E+02</td>
<td>1.2E+01</td>
<td>3.1E+01</td>
<td>8.7E+00</td>
<td>3.3E+01</td>
<td>8.3E+00</td>
<td>1.2E+02</td>
<td>41.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/21 23:45:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>T-3</td>
<td>NaN</td>
<td>1.1E+03</td>
<td>2.0E+01</td>
<td>4.6E+01</td>
<td>1.4E+01</td>
<td>4.0E+01</td>
<td>1.4E+01</td>
<td>ND</td>
<td>88.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/22 14:28:00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>T-4</td>
<td>NaN</td>
<td>6.7E+02</td>
<td>1.9E+01</td>
<td>3.9E+01</td>
<td>1.1E+01</td>
<td>4.4E+01</td>
<td>1.1E+01</td>
<td>ND</td>
<td>79.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/22 15:06:00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>T-3</td>
<td>NaN</td>
<td>7.4E+02</td>
<td>2.7E+01</td>
<td>5.1E+01</td>
<td>2.0E+01</td>
<td>5.5E+01</td>
<td>2.0E+01</td>
<td>2.0E+02</td>
<td>58.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>34.0</td>
<td>25.0</td>
<td>NaN</td>
<td>2011/3/23 13:51:00</td>
</tr>
</tbody>
</table>

<p>5 rows × 49 columns</p>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L190" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="georef_data" class="level3">
<h3 class="anchored" data-anchor-id="georef_data">georef_data</h3>
<blockquote class="blockquote">
<pre><code> georef_data (df_meas, df_locs)</code></pre>
</blockquote>
<p><em>Georeference measurements dataframe using locations dataframe.</em></p>
<div id="0828b398" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> georef_data(df_meas, df_locs):</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Georeference measurements dataframe using locations dataframe."</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="st">"Sampling point number"</span> <span class="kw">in</span> df_meas.columns <span class="kw">and</span> <span class="st">"STATION"</span> <span class="kw">in</span> df_locs.columns</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.merge(df_meas, df_locs, how<span class="op">=</span><span class="st">"inner"</span>, </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                    left_on<span class="op">=</span><span class="st">'Sampling point number'</span>, right_on<span class="op">=</span><span class="st">'STATION'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="3f816d88" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df_meas_georef <span class="op">=</span> georef_data(df_meas, df_locs)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>df_meas_georef.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sampling point number</th>
<th data-quarto-table-cell-role="th">Collection layer of seawater</th>
<th data-quarto-table-cell-role="th">131I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">131I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">125Sb radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">125Sb detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">Unnamed: 49</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">org</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>T-3</td>
<td>NaN</td>
<td>1.1E+03</td>
<td>1.3E+01</td>
<td>4.8E+01</td>
<td>9.2E+00</td>
<td>5.3E+01</td>
<td>8.8E+00</td>
<td>1.6E+02</td>
<td>44.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/21 23:15:00</td>
<td>T-3</td>
<td>141.026389</td>
<td>37.322222</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>T-4</td>
<td>NaN</td>
<td>6.6E+02</td>
<td>1.2E+01</td>
<td>3.1E+01</td>
<td>8.7E+00</td>
<td>3.3E+01</td>
<td>8.3E+00</td>
<td>1.2E+02</td>
<td>41.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/21 23:45:00</td>
<td>T-4</td>
<td>141.013889</td>
<td>37.241667</td>
<td>TEPCO</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>T-3</td>
<td>NaN</td>
<td>1.1E+03</td>
<td>2.0E+01</td>
<td>4.6E+01</td>
<td>1.4E+01</td>
<td>4.0E+01</td>
<td>1.4E+01</td>
<td>ND</td>
<td>88.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/22 14:28:00</td>
<td>T-3</td>
<td>141.026389</td>
<td>37.322222</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>T-4</td>
<td>NaN</td>
<td>6.7E+02</td>
<td>1.9E+01</td>
<td>3.9E+01</td>
<td>1.1E+01</td>
<td>4.4E+01</td>
<td>1.1E+01</td>
<td>ND</td>
<td>79.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/22 15:06:00</td>
<td>T-4</td>
<td>141.013889</td>
<td>37.241667</td>
<td>TEPCO</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>T-3</td>
<td>NaN</td>
<td>7.4E+02</td>
<td>2.7E+01</td>
<td>5.1E+01</td>
<td>2.0E+01</td>
<td>5.5E+01</td>
<td>2.0E+01</td>
<td>2.0E+02</td>
<td>58.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>34.0</td>
<td>25.0</td>
<td>NaN</td>
<td>2011/3/23 13:51:00</td>
<td>T-3</td>
<td>141.026389</td>
<td>37.322222</td>
<td>TEPCO</td>
</tr>
</tbody>
</table>

<p>5 rows × 53 columns</p>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/helcom.py#L87" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="load_data" class="level3">
<h3 class="anchored" data-anchor-id="load_data">load_data</h3>
<blockquote class="blockquote">
<pre><code> load_data (fname_coastal_water, fname_clos1F, fname_iaea_orbs)</code></pre>
</blockquote>
<p><em>Load, align and georeference TEPCO data</em></p>
<div id="91d21a58" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_data(fname_coastal_water, fname_clos1F, fname_iaea_orbs):</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Load, align and georeference TEPCO data"</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    df_locs <span class="op">=</span> concat_locs(</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>        [get_locs_coastal_water(fname_coastal_water), </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>         get_locs_clos1F(fname_clos1F),</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>         get_locs_orbs(fname_iaea_orbs)])</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    df_meas <span class="op">=</span> concat_dfs(get_coastal_water_df(fname_coastal_water), get_clos1F_df(fname_clos1F))</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    df_meas.dropna(subset<span class="op">=</span>[<span class="st">'Sampling point number'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">'SEAWATER'</span>: georef_data(df_meas, df_locs)}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="a1853b49" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>dfs <span class="op">=</span> load_data(fname_coastal_water, fname_clos1F, fname_iaea_orbs)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>dfs[<span class="st">'SEAWATER'</span>].head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 11/11 [00:05&lt;00:00,  2.14it/s]
100%|██████████| 11/11 [00:05&lt;00:00,  2.14it/s]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sampling point number</th>
<th data-quarto-table-cell-role="th">Collection layer of seawater</th>
<th data-quarto-table-cell-role="th">131I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">131I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">125Sb radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">125Sb detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">Unnamed: 49</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">org</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>T-3</td>
<td>NaN</td>
<td>1.1E+03</td>
<td>1.3E+01</td>
<td>4.8E+01</td>
<td>9.2E+00</td>
<td>5.3E+01</td>
<td>8.8E+00</td>
<td>1.6E+02</td>
<td>44.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/21 23:15:00</td>
<td>T-3</td>
<td>141.026389</td>
<td>37.322222</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>T-4</td>
<td>NaN</td>
<td>6.6E+02</td>
<td>1.2E+01</td>
<td>3.1E+01</td>
<td>8.7E+00</td>
<td>3.3E+01</td>
<td>8.3E+00</td>
<td>1.2E+02</td>
<td>41.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/21 23:45:00</td>
<td>T-4</td>
<td>141.013889</td>
<td>37.241667</td>
<td>TEPCO</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>T-3</td>
<td>NaN</td>
<td>1.1E+03</td>
<td>2.0E+01</td>
<td>4.6E+01</td>
<td>1.4E+01</td>
<td>4.0E+01</td>
<td>1.4E+01</td>
<td>ND</td>
<td>88.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/22 14:28:00</td>
<td>T-3</td>
<td>141.026389</td>
<td>37.322222</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>T-4</td>
<td>NaN</td>
<td>6.7E+02</td>
<td>1.9E+01</td>
<td>3.9E+01</td>
<td>1.1E+01</td>
<td>4.4E+01</td>
<td>1.1E+01</td>
<td>ND</td>
<td>79.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/22 15:06:00</td>
<td>T-4</td>
<td>141.013889</td>
<td>37.241667</td>
<td>TEPCO</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>T-3</td>
<td>NaN</td>
<td>7.4E+02</td>
<td>2.7E+01</td>
<td>5.1E+01</td>
<td>2.0E+01</td>
<td>5.5E+01</td>
<td>2.0E+01</td>
<td>2.0E+02</td>
<td>58.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>34.0</td>
<td>25.0</td>
<td>NaN</td>
<td>2011/3/23 13:51:00</td>
<td>T-3</td>
<td>141.026389</td>
<td>37.322222</td>
<td>TEPCO</td>
</tr>
</tbody>
</table>

<p>5 rows × 53 columns</p>
</div>
</div>
</div>
<div id="f68389c5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"# of cols, rows: </span><span class="sc">{</span>dfs[<span class="st">'SEAWATER'</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>dfs[<span class="st">'SEAWATER'</span>].head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># of cols, rows: (49863, 53)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sampling point number</th>
<th data-quarto-table-cell-role="th">Collection layer of seawater</th>
<th data-quarto-table-cell-role="th">131I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">131I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">125Sb radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">125Sb detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">Unnamed: 49</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">org</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>T-3</td>
<td>NaN</td>
<td>1.1E+03</td>
<td>1.3E+01</td>
<td>4.8E+01</td>
<td>9.2E+00</td>
<td>5.3E+01</td>
<td>8.8E+00</td>
<td>1.6E+02</td>
<td>44.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/21 23:15:00</td>
<td>T-3</td>
<td>141.026389</td>
<td>37.322222</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>T-4</td>
<td>NaN</td>
<td>6.6E+02</td>
<td>1.2E+01</td>
<td>3.1E+01</td>
<td>8.7E+00</td>
<td>3.3E+01</td>
<td>8.3E+00</td>
<td>1.2E+02</td>
<td>41.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/21 23:45:00</td>
<td>T-4</td>
<td>141.013889</td>
<td>37.241667</td>
<td>TEPCO</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>T-3</td>
<td>NaN</td>
<td>1.1E+03</td>
<td>2.0E+01</td>
<td>4.6E+01</td>
<td>1.4E+01</td>
<td>4.0E+01</td>
<td>1.4E+01</td>
<td>ND</td>
<td>88.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/22 14:28:00</td>
<td>T-3</td>
<td>141.026389</td>
<td>37.322222</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>T-4</td>
<td>NaN</td>
<td>6.7E+02</td>
<td>1.9E+01</td>
<td>3.9E+01</td>
<td>1.1E+01</td>
<td>4.4E+01</td>
<td>1.1E+01</td>
<td>ND</td>
<td>79.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011/3/22 15:06:00</td>
<td>T-4</td>
<td>141.013889</td>
<td>37.241667</td>
<td>TEPCO</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>T-3</td>
<td>NaN</td>
<td>7.4E+02</td>
<td>2.7E+01</td>
<td>5.1E+01</td>
<td>2.0E+01</td>
<td>5.5E+01</td>
<td>2.0E+01</td>
<td>2.0E+02</td>
<td>58.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>34.0</td>
<td>25.0</td>
<td>NaN</td>
<td>2011/3/23 13:51:00</td>
<td>T-3</td>
<td>141.026389</td>
<td>37.322222</td>
<td>TEPCO</td>
</tr>
</tbody>
</table>

<p>5 rows × 53 columns</p>
</div>
</div>
</div>
<div id="993a33d8" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>dfs[<span class="st">'SEAWATER'</span>].STATION.unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>array(['T-3', 'T-4', 'T-5', 'T-7', 'T-11', 'T-12', 'T-14', 'T-18', 'T-20',
       'T-22', 'T-MA', 'T-M10', 'T-A', 'T-D', 'T-E', 'T-B', 'T-C',
       'T-MG1', 'T-MG2', 'T-MG3', 'T-MG4', 'T-MG5', 'T-MG6', 'T-D1',
       'T-D5', 'T-D9', 'T-E1', 'T-G4', 'T-H1', 'T-S5', 'T-S6', 'T-17-1',
       'T-B3', 'T-13-1', 'T-S3', 'T-S4', 'T-B4', 'T-S1', 'T-S2', 'T-MG0',
       'T-Z', 'T-B1', 'T-B2', 'T-S7', 'T-S8', 'T-0', 'T-4-1', 'T-4-2',
       'T-6', 'T-0-1', 'T-0-1A', 'T-0-2', 'T-0-3', 'T-0-3A', 'T-1', 'T-2',
       'T-2-1', 'T-A1', 'T-A2', 'T-A3'], dtype=object)</code></pre>
</div>
</div>
<div id="226b8c3e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>(dfs[<span class="st">'SEAWATER'</span>] <span class="op">==</span> <span class="st">"ND"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Sampling point number                                 0
Collection layer of seawater                          0
131I radioactivity concentration (Bq/L)            8642
131I detection limit (Bq/L)                           0
134Cs radioactivity concentration (Bq/L)          30967
134Cs detection limit (Bq/L)                          0
137Cs radioactivity concentration (Bq/L)          17232
137Cs detection limit (Bq/L)                          0
132I radioactivity concentration (Bq/L)               3
132I detection limit (Bq/L)                           0
132Te radioactivity concentration (Bq/L)              0
132Te detection limit (Bq/L)                          0
136Cs radioactivity concentration (Bq/L)              2
136Cs detection limit (Bq/L)                          0
140La radioactivity concentration (Bq/L)              0
140La detection limit (Bq/L)                          0
89Sr radioactivity concentration (Bq/L)             101
89Sr detection limit (Bq/L)                           0
90Sr radioactivity concentration (Bq/L)             344
90Sr detection limit (Bq/L)                           0
238Pu radioactivity concentration (Bq/L)            309
238Pu detection limit (Bq/L)                          0
239Pu+240Pu radioactivity concentration (Bq/L)      231
239Pu+240Pu statistical error (Bq/L)                  0
239Pu+240Pu detection limit (Bq/L)                    0
Total alpha radioactivity concentration (Bq/L)      983
Total alpha detection limit (Bq/L)                    0
Total beta radioactivity concentration (Bq/L)      4919
Total beta detection limit (Bq/L)                     0
140Ba radioactivity concentration (Bq/L)              0
140Ba detection limit (Bq/L)                          0
106Ru radioactivity concentration (Bq/L)              0
106Ru detection limit (Bq/L)                          0
58Co radioactivity concentration (Bq/L)               3
58Co detection limit (Bq/L)                           0
60Co radioactivity concentration (Bq/L)               9
60Co detection limit (Bq/L)                           0
144Ce radioactivity concentration (Bq/L)              9
144Ce detection limit (Bq/L)                          0
54Mn radioactivity concentration (Bq/L)               9
54Mn detection limit (Bq/L)                           0
3H radioactivity concentration (Bq/L)              9657
3H detection limit (Bq/L)                             0
125Sb radioactivity concentration (Bq/L)            647
125Sb detection limit (Bq/L)                          0
105Ru radioactivity concentration (Bq/L)              0
105Ru detection limit (Bq/L)                          0
Unnamed: 49                                           0
TIME                                                  0
STATION                                               0
LON                                                   0
LAT                                                   0
org                                                   0
dtype: int64</code></pre>
</div>
</div>
<div id="b01a3025" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>dfs[<span class="st">'SEAWATER'</span>][[<span class="st">'TIME'</span>, <span class="st">'134Cs radioactivity concentration (Bq/L)'</span>, <span class="st">'134Cs detection limit (Bq/L)'</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">134Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs detection limit (Bq/L)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2011/3/21 23:15:00</td>
<td>4.8E+01</td>
<td>9.2E+00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2011/3/21 23:45:00</td>
<td>3.1E+01</td>
<td>8.7E+00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2011/3/22 14:28:00</td>
<td>4.6E+01</td>
<td>1.4E+01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>2011/3/22 15:06:00</td>
<td>3.9E+01</td>
<td>1.1E+01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2011/3/23 13:51:00</td>
<td>5.1E+01</td>
<td>2.0E+01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">49858</th>
<td>2025/06/30 08:05</td>
<td>ND</td>
<td>0.4</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">49859</th>
<td>2025/07/07 08:36</td>
<td>ND</td>
<td>0.37</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">49860</th>
<td>2025/07/17 08:11</td>
<td>ND</td>
<td>0.29</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">49861</th>
<td>2025/07/21 08:20</td>
<td>ND</td>
<td>0.36</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">49862</th>
<td>2025/07/24 07:39</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>49863 rows × 3 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="remove-約-about-character" class="level2">
<h2 class="anchored" data-anchor-id="remove-約-about-character">Remove 約 (about) character</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>FEEDBACK TO DATA PROVIDER
</div>
</div>
<div class="callout-body-container callout-body">
<p>We systematically remove the <code>約</code> character. Please confirm that this is the correct way to handle this. We could imagine that mentioning uncertainty would be less ambiguous in future.</p>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L208" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="removejapanasecharcb" class="level3">
<h3 class="anchored" data-anchor-id="removejapanasecharcb">RemoveJapanaseCharCB</h3>
<blockquote class="blockquote">
<pre><code> RemoveJapanaseCharCB ()</code></pre>
</blockquote>
<p><em>Remove 約 (about) char</em></p>
<div id="ec010817" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> RemoveJapanaseCharCB(Callback):</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Remove 約 (about) char"</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _transform_if_about(<span class="va">self</span>, value, about_char<span class="op">=</span><span class="st">'約'</span>):</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pd.isna(value): <span class="cf">return</span> value</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (value.replace(about_char, <span class="st">''</span>) <span class="cf">if</span> <span class="bu">str</span>(value).count(about_char) <span class="op">!=</span> <span class="dv">0</span> </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> value)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, tfm): </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> tfm.dfs.keys():</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>            cols_rdn <span class="op">=</span> [c <span class="cf">for</span> c <span class="kw">in</span> tfm.dfs[k].columns <span class="cf">if</span> (<span class="st">'(Bq/L)'</span> <span class="kw">in</span> c) <span class="kw">and</span> (tfm.dfs[k][c].dtype <span class="op">==</span> <span class="st">'object'</span>)]</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>            tfm.dfs[k][cols_rdn] <span class="op">=</span> tfm.dfs[k][cols_rdn].<span class="bu">map</span>(<span class="va">self</span>._transform_if_about)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="29af29b5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB()])</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>tfm()[<span class="st">'SEAWATER'</span>].sample(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sampling point number</th>
<th data-quarto-table-cell-role="th">Collection layer of seawater</th>
<th data-quarto-table-cell-role="th">131I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">131I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">125Sb radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">125Sb detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">Unnamed: 49</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">org</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">24196</th>
<td>T-D5</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2024/1/6 08:28:00</td>
<td>T-D5</td>
<td>141.072222</td>
<td>37.416667</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3988</th>
<td>T-D5</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2012/10/16 09:40:00</td>
<td>T-D5</td>
<td>141.072222</td>
<td>37.416667</td>
<td>TEPCO</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">9505</th>
<td>T-5</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>1.8E-03</td>
<td>3.9E-03</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2015/7/6 08:22:00</td>
<td>T-5</td>
<td>141.200000</td>
<td>37.416667</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">35102</th>
<td>T-1</td>
<td>上層</td>
<td>ND</td>
<td>0.49</td>
<td>ND</td>
<td>1.2</td>
<td>ND</td>
<td>1.5</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2012/05/31 08:50:00</td>
<td>T-1</td>
<td>141.034444</td>
<td>37.431111</td>
<td>TEPCO</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">26240</th>
<td>T-14</td>
<td>下層</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>1.4E-03</td>
<td>2.0E-03</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2025/1/6 07:40:00</td>
<td>T-14</td>
<td>141.062500</td>
<td>37.552778</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">27384</th>
<td>T-0-1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>0.71</td>
<td>ND</td>
<td>0.68</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2014/06/24 09:53:00</td>
<td>T-0-1</td>
<td>141.040278</td>
<td>37.430556</td>
<td>TEPCO</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">39086</th>
<td>T-1</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>0.78</td>
<td>ND</td>
<td>0.58</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020/12/24 07:45:00</td>
<td>T-1</td>
<td>141.034444</td>
<td>37.431111</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">18880</th>
<td>T-D9</td>
<td>下層</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>1.3E-03</td>
<td>4.2E-03</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020/11/24 09:38:00</td>
<td>T-D9</td>
<td>141.072167</td>
<td>37.333333</td>
<td>TEPCO</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">17717</th>
<td>T-MG1</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>1.2E-03</td>
<td>3.9E-03</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020/3/19 10:30:00</td>
<td>T-MG1</td>
<td>141.283333</td>
<td>38.333333</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">17990</th>
<td>T-5</td>
<td>下層</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>1.3E-03</td>
<td>1.9E-03</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020/5/18 07:34:00</td>
<td>T-5</td>
<td>141.200000</td>
<td>37.416667</td>
<td>TEPCO</td>
</tr>
</tbody>
</table>

<p>10 rows × 53 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="fix-values-range-string" class="level2">
<h2 class="anchored" data-anchor-id="fix-values-range-string">Fix values range string</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>FEEDBACK TO DATA PROVIDER
</div>
</div>
<div class="callout-body-container callout-body">
<p>Value ranges are provided as strings (e.g ‘4.0E+00&lt;&amp;&lt;8.0E+00’ or ‘1.0～2.7’). We replace them by their mean. Please confirm that this is the correct way to handle this. Again, mentioning uncertainty would be less ambiguous in future.</p>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L221" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="fixrangevaluestringcb" class="level3">
<h3 class="anchored" data-anchor-id="fixrangevaluestringcb">FixRangeValueStringCB</h3>
<blockquote class="blockquote">
<pre><code> FixRangeValueStringCB ()</code></pre>
</blockquote>
<p><em>Replace range values (e.g ‘4.0E+00&lt;&amp;&lt;8.0E+00’ or ‘1.0～2.7’) by their mean</em></p>
<div id="07ba7ca4" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> FixRangeValueStringCB(Callback):</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Replace range values (e.g '4.0E+00&lt;&amp;&lt;8.0E+00' or '1.0～2.7') by their mean"</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _extract_and_calculate_mean(<span class="va">self</span>, s):</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For scientific notation ranges</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>        float_strings <span class="op">=</span> re.findall(<span class="vs">r"</span><span class="pp">[+-]</span><span class="op">?</span><span class="dv">\d</span><span class="op">+</span><span class="ch">\.</span><span class="op">?</span><span class="dv">\d</span><span class="op">*</span><span class="vs">E</span><span class="op">?</span><span class="pp">[+-]</span><span class="op">?</span><span class="dv">\d</span><span class="op">*</span><span class="vs">"</span>, s)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> float_strings:</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>            float_numbers <span class="op">=</span> np.array(float_strings, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> float_numbers.mean()</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> s</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _transform_if_range(<span class="va">self</span>, value):</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pd.isna(value): </span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> value</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="bu">str</span>(value)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check for both range patterns</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'&lt;&amp;&lt;'</span> <span class="kw">in</span> value <span class="kw">or</span> <span class="st">'～'</span> <span class="kw">in</span> value:</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._extract_and_calculate_mean(value)</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> value</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, tfm): </span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> tfm.dfs.keys():</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>            cols_rdn <span class="op">=</span> [c <span class="cf">for</span> c <span class="kw">in</span> tfm.dfs[k].columns </span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>                       <span class="cf">if</span> (<span class="st">'(Bq/L)'</span> <span class="kw">in</span> c) <span class="kw">and</span> (tfm.dfs[k][c].dtype <span class="op">==</span> <span class="st">'object'</span>)]</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># tfm.dfs[k][cols_rdn] = tfm.dfs[k][cols_rdn].map(self._transform_if_range).astype(float)</span></span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>            tfm.dfs[k][cols_rdn] <span class="op">=</span> tfm.dfs[k][cols_rdn].<span class="bu">map</span>(<span class="va">self</span>._transform_if_range)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="ea5c7404" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB(),</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    FixRangeValueStringCB()</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> tfm()[<span class="st">'SEAWATER'</span>]</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>df_test.sample(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sampling point number</th>
<th data-quarto-table-cell-role="th">Collection layer of seawater</th>
<th data-quarto-table-cell-role="th">131I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">131I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">132I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">125Sb radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">125Sb detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">Unnamed: 49</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">org</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">12202</th>
<td>T-14</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>1.3E-03</td>
<td>6.6E-03</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2016/12/13 08:44:00</td>
<td>T-14</td>
<td>141.062500</td>
<td>37.552778</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">24157</th>
<td>T-18</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2023/12/25 09:21:00</td>
<td>T-18</td>
<td>140.922222</td>
<td>36.905556</td>
<td>TEPCO</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">39939</th>
<td>T-1</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>0.69</td>
<td>ND</td>
<td>0.81</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2022/10/05 07:40:00</td>
<td>T-1</td>
<td>141.034444</td>
<td>37.431111</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">30050</th>
<td>T-0-1A</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2024/05/25 07:00:00</td>
<td>T-0-1A</td>
<td>141.046667</td>
<td>37.430556</td>
<td>TEPCO</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">34441</th>
<td>T-0-3A</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>0.39</td>
<td>ND</td>
<td>0.34</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2024/07/15 07:45:00</td>
<td>T-0-3A</td>
<td>141.046667</td>
<td>37.416111</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">4229</th>
<td>T-MG5</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>5.0E-03</td>
<td>NaN</td>
<td>8.9E-03</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2012/11/22 09:11:00</td>
<td>T-MG5</td>
<td>141.250000</td>
<td>38.166667</td>
<td>TEPCO</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">29278</th>
<td>T-0-1A</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>0.81</td>
<td>ND</td>
<td>0.65</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2018/04/24 06:55:00</td>
<td>T-0-1A</td>
<td>141.046667</td>
<td>37.430556</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">40055</th>
<td>T-1</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2023/01/02 07:57:00</td>
<td>T-1</td>
<td>141.034444</td>
<td>37.431111</td>
<td>TEPCO</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">38436</th>
<td>T-1</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2019/08/19 07:55:00</td>
<td>T-1</td>
<td>141.034444</td>
<td>37.431111</td>
<td>TEPCO</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">22261</th>
<td>T-D9</td>
<td>上層</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>1.2E-03</td>
<td>2.0E-03</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2022/11/15 09:01:00</td>
<td>T-D9</td>
<td>141.072167</td>
<td>37.333333</td>
<td>TEPCO</td>
</tr>
</tbody>
</table>

<p>10 rows × 53 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="select-columns-of-interest" class="level2">
<h2 class="anchored" data-anchor-id="select-columns-of-interest">Select columns of interest</h2>
<p>We select the columns of interest and in particular the elements of interest, in our case radionuclides.</p>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/geotraces.py#L60" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="selectcolsofinterestcb" class="level3">
<h3 class="anchored" data-anchor-id="selectcolsofinterestcb">SelectColsOfInterestCB</h3>
<blockquote class="blockquote">
<pre><code> SelectColsOfInterestCB (common_coi, nuclides_pattern)</code></pre>
</blockquote>
<p><em>Select columns of interest.</em></p>
<div id="03f33095" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>common_coi <span class="op">=</span> [<span class="st">'LON'</span>, <span class="st">'LAT'</span>, <span class="st">'TIME'</span>, <span class="st">'STATION'</span>]</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>nuclides_pattern <span class="op">=</span> <span class="st">'(Bq/L)'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="55ecc976" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SelectColsOfInterestCB(Callback):</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Select columns of interest."</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, common_coi, nuclides_pattern): fc.store_attr()</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, tfm):</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>        nuc_of_interest <span class="op">=</span> [c <span class="cf">for</span> c <span class="kw">in</span> tfm.dfs[<span class="st">'SEAWATER'</span>].columns <span class="cf">if</span> nuclides_pattern <span class="kw">in</span> c]</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>] <span class="op">=</span> tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="va">self</span>.common_coi <span class="op">+</span> nuc_of_interest]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="b96565de" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB(),</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    FixRangeValueStringCB(),</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    SelectColsOfInterestCB(common_coi, nuclides_pattern)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> tfm()[<span class="st">'SEAWATER'</span>] </span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>df_test.sample(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">131I radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">131I detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">134Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">137Cs detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">144Ce radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">144Ce detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">54Mn radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">54Mn detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">3H radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">3H detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">125Sb radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">125Sb detection limit (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru radioactivity concentration (Bq/L)</th>
<th data-quarto-table-cell-role="th">105Ru detection limit (Bq/L)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">46500</th>
<td>141.033611</td>
<td>37.415833</td>
<td>2025/05/12 07:50</td>
<td>T-2</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>0.67</td>
<td>ND</td>
<td>0.82</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">34387</th>
<td>141.046667</td>
<td>37.416111</td>
<td>2024/03/04 08:22:00</td>
<td>T-0-3A</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>0.36</td>
<td>ND</td>
<td>0.23</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>9.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">45183</th>
<td>141.033611</td>
<td>37.415833</td>
<td>2022/11/13 08:47:00</td>
<td>T-2</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>0.74</td>
<td>ND</td>
<td>0.67</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">44254</th>
<td>141.033611</td>
<td>37.415833</td>
<td>2021/01/28 07:05:00</td>
<td>T-2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">12995</th>
<td>141.666667</td>
<td>38.300000</td>
<td>2017/6/6 08:25:00</td>
<td>T-MG2</td>
<td>NaN</td>
<td>NaN</td>
<td>ND</td>
<td>1.4E-03</td>
<td>1.6E-03</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>5 rows × 49 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="reshape-wide-to-long" class="level2">
<h2 class="anchored" data-anchor-id="reshape-wide-to-long">Reshape: wide to long</h2>
<p>So that we can extract information such as nuclide name, unit, derived quantities such as uncertainty, detection limit, …</p>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/geotraces.py#L70" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="widetolongcb" class="level3">
<h3 class="anchored" data-anchor-id="widetolongcb">WideToLongCB</h3>
<blockquote class="blockquote">
<pre><code> WideToLongCB (id_vars=['LON', 'LAT', 'TIME', 'STATION'])</code></pre>
</blockquote>
<p><em>Get TEPCO nuclide names as values not column names to extract contained information (nuclide name, unc, dl, …).</em></p>
<div id="2552cf0a" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> WideToLongCB(Callback):</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Get TEPCO nuclide names as values not column names </span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co">    to extract contained information (nuclide name, unc, dl, ...).</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, id_vars<span class="op">=</span>[<span class="st">'LON'</span>, <span class="st">'LAT'</span>, <span class="st">'TIME'</span>, <span class="st">'STATION'</span>]): </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>        fc.store_attr()</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, tfm): </span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>] <span class="op">=</span> pd.melt(tfm.dfs[<span class="st">'SEAWATER'</span>], id_vars<span class="op">=</span><span class="va">self</span>.id_vars)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="0c74ada2" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB(),</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    FixRangeValueStringCB(),</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    SelectColsOfInterestCB(common_coi, nuclides_pattern),</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    WideToLongCB()</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> tfm()[<span class="st">'SEAWATER'</span>] </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>df_test.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">variable</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>141.026389</td>
<td>37.322222</td>
<td>2011/3/21 23:15:00</td>
<td>T-3</td>
<td>131I radioactivity concentration (Bq/L)</td>
<td>1.1E+03</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>141.013889</td>
<td>37.241667</td>
<td>2011/3/21 23:45:00</td>
<td>T-4</td>
<td>131I radioactivity concentration (Bq/L)</td>
<td>6.6E+02</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>141.026389</td>
<td>37.322222</td>
<td>2011/3/22 14:28:00</td>
<td>T-3</td>
<td>131I radioactivity concentration (Bq/L)</td>
<td>1.1E+03</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>141.013889</td>
<td>37.241667</td>
<td>2011/3/22 15:06:00</td>
<td>T-4</td>
<td>131I radioactivity concentration (Bq/L)</td>
<td>6.7E+02</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>141.026389</td>
<td>37.322222</td>
<td>2011/3/23 13:51:00</td>
<td>T-3</td>
<td>131I radioactivity concentration (Bq/L)</td>
<td>7.4E+02</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="extract" class="level2">
<h2 class="anchored" data-anchor-id="extract">Extract</h2>
<p>Nulide name, dl, unc, … are extracted from column names as embedded in TEPCO data source.</p>
<section id="nuclide-name" class="level3">
<h3 class="anchored" data-anchor-id="nuclide-name">Nuclide name</h3>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L274" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="extract_nuclide" class="level3">
<h3 class="anchored" data-anchor-id="extract_nuclide">extract_nuclide</h3>
<blockquote class="blockquote">
<pre><code> extract_nuclide (text:str)</code></pre>
</blockquote>
<p><em>Extract the nuclide identifier from a measurement variable name using regex.</em></p>
<div id="597f8d61" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_nuclide(text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Extract the nuclide identifier from a measurement variable name using regex."</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    pattern <span class="op">=</span> <span class="vs">r'</span><span class="dv">^</span><span class="kw">(</span><span class="vs">Total</span><span class="dv">\s</span><span class="op">+</span>(?:<span class="vs">alpha</span><span class="cf">|</span><span class="vs">beta</span>)<span class="cf">|</span><span class="pp">[^</span><span class="dv">\s</span><span class="pp">]</span><span class="op">+</span><span class="kw">)</span><span class="vs">'</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    match <span class="op">=</span> re.match(pattern, text, re.IGNORECASE)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> match.group(<span class="dv">1</span>) <span class="cf">if</span> match <span class="cf">else</span> text</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>For instance:</p>
<div id="c88cf14c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(extract_nuclide(<span class="st">"Total alpha radioactivity concentration (Bq/L)"</span>))</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(extract_nuclide(<span class="st">"131I radioactivity concentration (Bq/L)"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total alpha
131I</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L281" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="extractnuclidenamecb" class="level3">
<h3 class="anchored" data-anchor-id="extractnuclidenamecb">ExtractNuclideNameCB</h3>
<blockquote class="blockquote">
<pre><code> ExtractNuclideNameCB (src_col='variable', dest_col='NUCLIDE')</code></pre>
</blockquote>
<p><em>Extract nuclide name from TEPCO data.</em></p>
<div id="f526c107" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ExtractNuclideNameCB(Callback):</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Extract nuclide name from TEPCO data."</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, src_col<span class="op">=</span><span class="st">'variable'</span>, dest_col<span class="op">=</span><span class="st">'NUCLIDE'</span>): fc.store_attr()</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, tfm): </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="va">self</span>.dest_col] <span class="op">=</span> tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="va">self</span>.src_col].<span class="bu">map</span>(extract_nuclide)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="25563734" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB(),</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    FixRangeValueStringCB(),</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    SelectColsOfInterestCB(common_coi, nuclides_pattern),</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>    WideToLongCB(),</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>    ExtractNuclideNameCB()</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> tfm()[<span class="st">'SEAWATER'</span>] </span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>df_test.sample(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">variable</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">NUCLIDE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">854848</th>
<td>141.200000</td>
<td>37.416667</td>
<td>2014/5/20 08:34:00</td>
<td>T-5</td>
<td>90Sr detection limit (Bq/L)</td>
<td>NaN</td>
<td>90Sr</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">125473</th>
<td>141.026389</td>
<td>37.322222</td>
<td>2024/10/15 12:40:00</td>
<td>T-3</td>
<td>134Cs radioactivity concentration (Bq/L)</td>
<td>NaN</td>
<td>134Cs</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">1684112</th>
<td>141.034444</td>
<td>37.431111</td>
<td>2020/01/15 08:00:00</td>
<td>T-1</td>
<td>60Co radioactivity concentration (Bq/L)</td>
<td>NaN</td>
<td>60Co</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">869803</th>
<td>140.702222</td>
<td>35.987500</td>
<td>2022/10/21 13:08:00</td>
<td>T-D</td>
<td>90Sr detection limit (Bq/L)</td>
<td>NaN</td>
<td>90Sr</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">366571</th>
<td>141.250000</td>
<td>38.166667</td>
<td>2020/2/7 09:22:00</td>
<td>T-MG5</td>
<td>132I detection limit (Bq/L)</td>
<td>NaN</td>
<td>132I</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="unit" class="level3">
<h3 class="anchored" data-anchor-id="unit">Unit</h3>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/geotraces.py#L87" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="extractunitcb" class="level3">
<h3 class="anchored" data-anchor-id="extractunitcb">ExtractUnitCB</h3>
<blockquote class="blockquote">
<pre><code> ExtractUnitCB (src_col='variable', dest_col='UNIT')</code></pre>
</blockquote>
<p><em>Extract unit from TEPCO data.</em></p>
<div id="d4259772" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ExtractUnitCB(Callback):</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Extract unit from TEPCO data."</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, src_col<span class="op">=</span><span class="st">'variable'</span>, dest_col<span class="op">=</span><span class="st">'UNIT'</span>): fc.store_attr()</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, tfm): </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="va">self</span>.dest_col] <span class="op">=</span> tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="va">self</span>.src_col].<span class="bu">str</span>.extract(<span class="vs">r'</span><span class="ch">\(</span><span class="kw">(</span><span class="dv">.</span><span class="op">*?</span><span class="kw">)</span><span class="ch">\)</span><span class="vs">'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="341573fe" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB(),</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    FixRangeValueStringCB(),</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>    SelectColsOfInterestCB(common_coi, nuclides_pattern),</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>    WideToLongCB(),</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>    ExtractNuclideNameCB(),</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>    ExtractUnitCB()</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> tfm()[<span class="st">'SEAWATER'</span>] </span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>df_test.sample(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">variable</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">NUCLIDE</th>
<th data-quarto-table-cell-role="th">UNIT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">938328</th>
<td>141.034444</td>
<td>37.431111</td>
<td>2024/07/08 07:51:00</td>
<td>T-1</td>
<td>238Pu radioactivity concentration (Bq/L)</td>
<td>NaN</td>
<td>238Pu</td>
<td>Bq/L</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2221110</th>
<td>141.072222</td>
<td>37.500000</td>
<td>2025/6/2 08:36:00</td>
<td>T-D1</td>
<td>105Ru detection limit (Bq/L)</td>
<td>NaN</td>
<td>105Ru</td>
<td>Bq/L</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">1951908</th>
<td>141.078889</td>
<td>37.458333</td>
<td>2014/5/29 06:07:00</td>
<td>T-S3</td>
<td>3H radioactivity concentration (Bq/L)</td>
<td>NaN</td>
<td>3H</td>
<td>Bq/L</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1077687</th>
<td>141.046667</td>
<td>37.423333</td>
<td>2016/02/01 08:16</td>
<td>T-0-2</td>
<td>239Pu+240Pu statistical error (Bq/L)</td>
<td>NaN</td>
<td>239Pu+240Pu</td>
<td>Bq/L</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">969934</th>
<td>141.233333</td>
<td>37.516667</td>
<td>2023/1/26 07:26:00</td>
<td>T-B2</td>
<td>238Pu detection limit (Bq/L)</td>
<td>NaN</td>
<td>238Pu</td>
<td>Bq/L</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="value-type" class="level3">
<h3 class="anchored" data-anchor-id="value-type">Value type</h3>
<p>Is it a measurement or derived detection such as detection limit or uncertainty?</p>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L295" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="extractvaluetypecb" class="level3">
<h3 class="anchored" data-anchor-id="extractvaluetypecb">ExtractValueTypeCB</h3>
<blockquote class="blockquote">
<pre><code> ExtractValueTypeCB (src_col='variable', dest_col='type')</code></pre>
</blockquote>
<p><em>Extract value type from TEPCO data.</em></p>
<div id="4c80a005" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ExtractValueTypeCB(Callback):</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Extract value type from TEPCO data."</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, src_col<span class="op">=</span><span class="st">'variable'</span>, dest_col<span class="op">=</span><span class="st">'type'</span>): fc.store_attr()</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, tfm): </span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="va">self</span>.dest_col] <span class="op">=</span> np.select(</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>            [</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>                tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="va">self</span>.src_col].<span class="bu">str</span>.contains(<span class="st">'detection limit'</span>, case<span class="op">=</span><span class="va">False</span>),</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>                tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="va">self</span>.src_col].<span class="bu">str</span>.contains(<span class="st">'statistical error'</span>, case<span class="op">=</span><span class="va">False</span>)],</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>            [<span class="st">'DL'</span>, <span class="st">'UNC'</span>],</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>            default<span class="op">=</span><span class="st">'VALUE'</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>        )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="648f26b3" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB(),</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>    FixRangeValueStringCB(),</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>    SelectColsOfInterestCB(common_coi, nuclides_pattern),</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    WideToLongCB(),</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>    ExtractNuclideNameCB(),</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>    ExtractUnitCB(),</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    ExtractValueTypeCB()</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> tfm()[<span class="st">'SEAWATER'</span>] </span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>df_test.sample(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">variable</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">NUCLIDE</th>
<th data-quarto-table-cell-role="th">UNIT</th>
<th data-quarto-table-cell-role="th">type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">1315127</th>
<td>141.000000</td>
<td>36.966667</td>
<td>2020/10/15 10:53:00</td>
<td>T-20</td>
<td>Total beta detection limit (Bq/L)</td>
<td>NaN</td>
<td>Total beta</td>
<td>Bq/L</td>
<td>DL</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1839912</th>
<td>141.033611</td>
<td>37.415833</td>
<td>2022/03/19 09:05:00</td>
<td>T-2</td>
<td>144Ce detection limit (Bq/L)</td>
<td>NaN</td>
<td>144Ce</td>
<td>Bq/L</td>
<td>DL</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">1842443</th>
<td>37.410000</td>
<td>141.030000</td>
<td>2014/08/11 05:35:00</td>
<td>T-2-1</td>
<td>144Ce detection limit (Bq/L)</td>
<td>NaN</td>
<td>144Ce</td>
<td>Bq/L</td>
<td>DL</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">36817</th>
<td>141.034444</td>
<td>37.431111</td>
<td>2016/03/20 07:45</td>
<td>T-1</td>
<td>131I radioactivity concentration (Bq/L)</td>
<td>ND</td>
<td>131I</td>
<td>Bq/L</td>
<td>VALUE</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">171526</th>
<td>141.072222</td>
<td>37.416667</td>
<td>2022/9/5 08:09:00</td>
<td>T-D5</td>
<td>134Cs detection limit (Bq/L)</td>
<td>1.4E-03</td>
<td>134Cs</td>
<td>Bq/L</td>
<td>DL</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="reshape-long-to-wide" class="level2">
<h2 class="anchored" data-anchor-id="reshape-long-to-wide">Reshape: long to wide</h2>
<p>Send <code>type</code> column to columns names (<code>VALUE</code>, <code>DL</code>, <code>UNC</code>)</p>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L308" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="longtowidecb" class="level3">
<h3 class="anchored" data-anchor-id="longtowidecb">LongToWideCB</h3>
<blockquote class="blockquote">
<pre><code> LongToWideCB (src_col='variable', dest_col='type')</code></pre>
</blockquote>
<p><em>Reshape: long to wide</em></p>
<div id="a97bec66" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LongToWideCB(Callback):</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Reshape: long to wide"</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, src_col<span class="op">=</span><span class="st">'variable'</span>, dest_col<span class="op">=</span><span class="st">'type'</span>): fc.store_attr()</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, tfm): </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>] <span class="op">=</span> pd.pivot_table(</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>            tfm.dfs[<span class="st">'SEAWATER'</span>],</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>            values<span class="op">=</span><span class="st">'value'</span>,</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>            index<span class="op">=</span>[<span class="st">'LON'</span>, <span class="st">'LAT'</span>, <span class="st">'TIME'</span>, <span class="st">'STATION'</span>, <span class="st">'NUCLIDE'</span>, <span class="st">'UNIT'</span>],</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>            columns<span class="op">=</span><span class="st">'type'</span>,</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>            aggfunc<span class="op">=</span><span class="st">'first'</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>        ).reset_index()</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>].reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>].rename(columns<span class="op">=</span>{<span class="st">'index'</span>: <span class="st">'SMP_ID'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="c44c4190" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB(),</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    FixRangeValueStringCB(),</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    SelectColsOfInterestCB(common_coi, nuclides_pattern),</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    WideToLongCB(),</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    ExtractNuclideNameCB(),</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>    ExtractUnitCB(),</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>    ExtractValueTypeCB(),</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>    LongToWideCB()</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> tfm()[<span class="st">'SEAWATER'</span>] </span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>df_test.sample(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">SMP_ID</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">NUCLIDE</th>
<th data-quarto-table-cell-role="th">UNIT</th>
<th data-quarto-table-cell-role="th">DL</th>
<th data-quarto-table-cell-role="th">UNC</th>
<th data-quarto-table-cell-role="th">VALUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">83649</th>
<td>83649</td>
<td>141.200000</td>
<td>37.233333</td>
<td>2011/8/26 07:40:00</td>
<td>T-7</td>
<td>134Cs</td>
<td>Bq/L</td>
<td>1.2E+01</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">37560</th>
<td>37560</td>
<td>141.034444</td>
<td>37.431111</td>
<td>2013/10/27 06:45:00</td>
<td>T-1</td>
<td>137Cs</td>
<td>Bq/L</td>
<td>NaN</td>
<td>NaN</td>
<td>1.4</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">18204</th>
<td>18204</td>
<td>141.026389</td>
<td>37.322222</td>
<td>2014/8/5 10:10:00</td>
<td>T-3</td>
<td>Total beta</td>
<td>Bq/L</td>
<td>1.7E+01</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">65718</th>
<td>65718</td>
<td>141.046667</td>
<td>37.430556</td>
<td>2022/10/03 07:10:00</td>
<td>T-0-1A</td>
<td>134Cs</td>
<td>Bq/L</td>
<td>0.31</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">69961</th>
<td>69961</td>
<td>141.050761</td>
<td>37.424686</td>
<td>2025/07/07 07:35</td>
<td>T-A2</td>
<td>3H</td>
<td>Bq/L</td>
<td>9.4</td>
<td>NaN</td>
<td>ND</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="fe746491" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>df_test[df_test.VALUE <span class="op">==</span> <span class="st">'ND'</span>].groupby(<span class="st">'NUCLIDE'</span>).size().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>NUCLIDE
134Cs          25186
137Cs          16447
3H              8976
131I            7958
Total beta      4913
Total alpha      979
125Sb            647
90Sr             342
238Pu            308
239Pu+240Pu      231
89Sr             100
144Ce              9
54Mn               9
60Co               9
58Co               3
132I               3
136Cs              2
dtype: int64</code></pre>
</div>
</div>
<div id="bc849748" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>df_test[df_test.VALUE <span class="op">==</span> <span class="st">'ND'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">SMP_ID</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">NUCLIDE</th>
<th data-quarto-table-cell-role="th">UNIT</th>
<th data-quarto-table-cell-role="th">DL</th>
<th data-quarto-table-cell-role="th">UNC</th>
<th data-quarto-table-cell-role="th">VALUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>0</td>
<td>37.210000</td>
<td>141.01</td>
<td>2012/10/16 07:25:00</td>
<td>T-4-1</td>
<td>131I</td>
<td>Bq/L</td>
<td>1.3E-01</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>1</td>
<td>37.210000</td>
<td>141.01</td>
<td>2012/10/16 07:25:00</td>
<td>T-4-1</td>
<td>134Cs</td>
<td>Bq/L</td>
<td>1.9E-01</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2</td>
<td>37.210000</td>
<td>141.01</td>
<td>2012/10/16 07:25:00</td>
<td>T-4-1</td>
<td>137Cs</td>
<td>Bq/L</td>
<td>2.7E-01</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>3</td>
<td>37.210000</td>
<td>141.01</td>
<td>2012/10/2 07:30:00</td>
<td>T-4-1</td>
<td>131I</td>
<td>Bq/L</td>
<td>1.1E-01</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>4</td>
<td>37.210000</td>
<td>141.01</td>
<td>2012/10/2 07:30:00</td>
<td>T-4-1</td>
<td>134Cs</td>
<td>Bq/L</td>
<td>2.2E-01</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">93158</th>
<td>93158</td>
<td>141.666667</td>
<td>38.30</td>
<td>2025/4/8 08:20:00</td>
<td>T-MG2</td>
<td>134Cs</td>
<td>Bq/L</td>
<td>1.3E-03</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">93160</th>
<td>93160</td>
<td>141.666667</td>
<td>38.30</td>
<td>2025/5/13 07:36:00</td>
<td>T-MG2</td>
<td>134Cs</td>
<td>Bq/L</td>
<td>1.2E-03</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">93162</th>
<td>93162</td>
<td>141.666667</td>
<td>38.30</td>
<td>2025/5/13 07:50:00</td>
<td>T-MG2</td>
<td>134Cs</td>
<td>Bq/L</td>
<td>8.7E-04</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">93164</th>
<td>93164</td>
<td>141.666667</td>
<td>38.30</td>
<td>2025/6/3 08:15:00</td>
<td>T-MG2</td>
<td>134Cs</td>
<td>Bq/L</td>
<td>1.1E-03</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">93166</th>
<td>93166</td>
<td>141.666667</td>
<td>38.30</td>
<td>2025/6/3 08:24:00</td>
<td>T-MG2</td>
<td>134Cs</td>
<td>Bq/L</td>
<td>1.2E-03</td>
<td>NaN</td>
<td>ND</td>
</tr>
</tbody>
</table>

<p>66122 rows × 10 columns</p>
</div>
</div>
</div>
<div id="96319dd1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>df_test.VALUE <span class="op">==</span> <span class="st">'ND'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>0         True
1         True
2         True
3         True
4         True
         ...  
93163    False
93164     True
93165    False
93166     True
93167    False
Name: VALUE, Length: 93168, dtype: bool</code></pre>
</div>
</div>
</section>
</section>
<section id="remap-unit-name-to-maris-nomenclature" class="level2">
<h2 class="anchored" data-anchor-id="remap-unit-name-to-maris-nomenclature">Remap <code>UNIT</code> name to MARIS nomenclature</h2>
<p>Data are reported in <code>Bq/L</code> but MARIS uses <code>Bq/m3</code> instead. So we assign it to MARIS <code>unit_id</code> = 3 (Bq/L). Later in the processing pipeline, we will convert the values from Bq/L to Bq/m3 by multiplying VALUE, DL, and DLV by 1000.</p>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L326" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="remapunitnamecb" class="level3">
<h3 class="anchored" data-anchor-id="remapunitnamecb">RemapUnitNameCB</h3>
<blockquote class="blockquote">
<pre><code> RemapUnitNameCB (unit_mapping)</code></pre>
</blockquote>
<p><em>Remap <code>UNIT</code> name to MARIS id.</em></p>
<div id="9a25a60b" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>unit_mapping <span class="op">=</span> {<span class="st">'Bq/L'</span>: <span class="dv">1</span>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="09d2c520" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> RemapUnitNameCB(Callback):</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Remap `UNIT` name to MARIS id.</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, unit_mapping): fc.store_attr()</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, tfm):</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'UNIT'</span>] <span class="op">=</span> tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'UNIT'</span>].<span class="bu">map</span>(<span class="va">self</span>.unit_mapping)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="8586e54b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB(),</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    FixRangeValueStringCB(),</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    SelectColsOfInterestCB(common_coi, nuclides_pattern),</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>    WideToLongCB(),</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>    ExtractNuclideNameCB(),</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>    ExtractUnitCB(),</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>    ExtractValueTypeCB(),</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>    LongToWideCB(),</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>    RemapUnitNameCB(unit_mapping)</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> tfm()[<span class="st">'SEAWATER'</span>] </span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>df_test.sample(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">SMP_ID</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">NUCLIDE</th>
<th data-quarto-table-cell-role="th">UNIT</th>
<th data-quarto-table-cell-role="th">DL</th>
<th data-quarto-table-cell-role="th">UNC</th>
<th data-quarto-table-cell-role="th">VALUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">81874</th>
<td>81874</td>
<td>141.133333</td>
<td>38.250000</td>
<td>2012/7/26 10:25:00</td>
<td>T-MG4</td>
<td>134Cs</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>6.8E-03</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">56188</th>
<td>56188</td>
<td>141.040556</td>
<td>37.478889</td>
<td>2015/2/3 09:15:00</td>
<td>T-6</td>
<td>3H</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>4.6E-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">74609</th>
<td>74609</td>
<td>141.072167</td>
<td>37.333333</td>
<td>2024/9/18 08:21:00</td>
<td>T-D9</td>
<td>137Cs</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>2.9E-03</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">36442</th>
<td>36442</td>
<td>141.034444</td>
<td>37.431111</td>
<td>2012/11/19 08:30:00</td>
<td>T-1</td>
<td>137Cs</td>
<td>1</td>
<td>1.4</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">36846</th>
<td>36846</td>
<td>141.034444</td>
<td>37.431111</td>
<td>2013/03/28 06:50:00</td>
<td>T-1</td>
<td>134Cs</td>
<td>1</td>
<td>1.1</td>
<td>NaN</td>
<td>ND</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="remap-nuclide-name-to-maris-nomenclature" class="level2">
<h2 class="anchored" data-anchor-id="remap-nuclide-name-to-maris-nomenclature">Remap <code>NUCLIDE</code> name to MARIS nomenclature</h2>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/helcom.py#L164" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="remapnuclidenamecb" class="level3">
<h3 class="anchored" data-anchor-id="remapnuclidenamecb">RemapNuclideNameCB</h3>
<blockquote class="blockquote">
<pre><code> RemapNuclideNameCB (nuclide_mapping)</code></pre>
</blockquote>
<p><em>Remap <code>NUCLIDE</code> name to MARIS id.</em></p>
<div id="c478c1c7" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>nuclide_mapping <span class="op">=</span> {</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'131I'</span>: <span class="dv">29</span>,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'134Cs'</span>: <span class="dv">31</span>,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'137Cs'</span>: <span class="dv">33</span>,</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'125Sb'</span>: <span class="dv">24</span>,</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Total beta'</span>: <span class="dv">103</span>,</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'238Pu'</span>: <span class="dv">67</span>,</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'239Pu+240Pu'</span>: <span class="dv">77</span>,</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'3H'</span>: <span class="dv">1</span>,</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'89Sr'</span>: <span class="dv">11</span>,</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'90Sr'</span>: <span class="dv">12</span>,</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Total alpha'</span>: <span class="dv">104</span>,</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'132I'</span>: <span class="dv">100</span>,</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'136Cs'</span>: <span class="dv">102</span>,</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'58Co'</span>: <span class="dv">8</span>,</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'105Ru'</span>: <span class="dv">97</span>,</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'106Ru'</span>: <span class="dv">17</span>,</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'140La'</span>: <span class="dv">35</span>,</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'140Ba'</span>: <span class="dv">34</span>,</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'132Te'</span>: <span class="dv">99</span>,</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'60Co'</span>: <span class="dv">9</span>,</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'144Ce'</span>: <span class="dv">37</span>,</span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'54Mn'</span>: <span class="dv">6</span></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="9893ee80" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> RemapNuclideNameCB(Callback):</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Remap `NUCLIDE` name to MARIS id."</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, nuclide_mapping): fc.store_attr()</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, tfm):</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'NUCLIDE'</span>] <span class="op">=</span> tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'NUCLIDE'</span>].<span class="bu">map</span>(<span class="va">self</span>.nuclide_mapping)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="983ad568" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB(),</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    FixRangeValueStringCB(),</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    SelectColsOfInterestCB(common_coi, nuclides_pattern),</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    WideToLongCB(),</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>    ExtractNuclideNameCB(),</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>    ExtractUnitCB(),</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>    ExtractValueTypeCB(),</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>    LongToWideCB(),</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>    RemapUnitNameCB(unit_mapping),</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>    RemapNuclideNameCB(nuclide_mapping)</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> tfm()[<span class="st">'SEAWATER'</span>] </span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>df_test.sample(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">SMP_ID</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">NUCLIDE</th>
<th data-quarto-table-cell-role="th">UNIT</th>
<th data-quarto-table-cell-role="th">DL</th>
<th data-quarto-table-cell-role="th">UNC</th>
<th data-quarto-table-cell-role="th">VALUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">63425</th>
<td>63425</td>
<td>141.046667</td>
<td>37.423333</td>
<td>2024/04/01 08:15:00</td>
<td>T-0-2</td>
<td>31</td>
<td>1</td>
<td>0.4</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">83876</th>
<td>83876</td>
<td>141.200000</td>
<td>37.233333</td>
<td>2019/6/6 06:58:00</td>
<td>T-7</td>
<td>31</td>
<td>1</td>
<td>1.2E-03</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">31743</th>
<td>31743</td>
<td>141.033611</td>
<td>37.415833</td>
<td>2023/07/31 08:55:00</td>
<td>T-2</td>
<td>103</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>10</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">68484</th>
<td>68484</td>
<td>141.047222</td>
<td>37.311111</td>
<td>2023/12/5 05:48:00</td>
<td>T-S7</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>1.5E-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">19853</th>
<td>19853</td>
<td>141.026389</td>
<td>37.322222</td>
<td>2025/3/4 12:20:00</td>
<td>T-3</td>
<td>1</td>
<td>1</td>
<td>3.6E-01</td>
<td>NaN</td>
<td>ND</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="fa0b08b4" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>df_test.dropna(subset<span class="op">=</span>[<span class="st">'DL'</span>, <span class="st">'VALUE'</span>], how<span class="op">=</span><span class="st">'any'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">SMP_ID</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">NUCLIDE</th>
<th data-quarto-table-cell-role="th">UNIT</th>
<th data-quarto-table-cell-role="th">DL</th>
<th data-quarto-table-cell-role="th">UNC</th>
<th data-quarto-table-cell-role="th">VALUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>0</td>
<td>37.210000</td>
<td>141.01</td>
<td>2012/10/16 07:25:00</td>
<td>T-4-1</td>
<td>29</td>
<td>1</td>
<td>1.3E-01</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>1</td>
<td>37.210000</td>
<td>141.01</td>
<td>2012/10/16 07:25:00</td>
<td>T-4-1</td>
<td>31</td>
<td>1</td>
<td>1.9E-01</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2</td>
<td>37.210000</td>
<td>141.01</td>
<td>2012/10/16 07:25:00</td>
<td>T-4-1</td>
<td>33</td>
<td>1</td>
<td>2.7E-01</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>3</td>
<td>37.210000</td>
<td>141.01</td>
<td>2012/10/2 07:30:00</td>
<td>T-4-1</td>
<td>29</td>
<td>1</td>
<td>1.1E-01</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>4</td>
<td>37.210000</td>
<td>141.01</td>
<td>2012/10/2 07:30:00</td>
<td>T-4-1</td>
<td>31</td>
<td>1</td>
<td>2.2E-01</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">93158</th>
<td>93158</td>
<td>141.666667</td>
<td>38.30</td>
<td>2025/4/8 08:20:00</td>
<td>T-MG2</td>
<td>31</td>
<td>1</td>
<td>1.3E-03</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">93160</th>
<td>93160</td>
<td>141.666667</td>
<td>38.30</td>
<td>2025/5/13 07:36:00</td>
<td>T-MG2</td>
<td>31</td>
<td>1</td>
<td>1.2E-03</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">93162</th>
<td>93162</td>
<td>141.666667</td>
<td>38.30</td>
<td>2025/5/13 07:50:00</td>
<td>T-MG2</td>
<td>31</td>
<td>1</td>
<td>8.7E-04</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">93164</th>
<td>93164</td>
<td>141.666667</td>
<td>38.30</td>
<td>2025/6/3 08:15:00</td>
<td>T-MG2</td>
<td>31</td>
<td>1</td>
<td>1.1E-03</td>
<td>NaN</td>
<td>ND</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">93166</th>
<td>93166</td>
<td>141.666667</td>
<td>38.30</td>
<td>2025/6/3 08:24:00</td>
<td>T-MG2</td>
<td>31</td>
<td>1</td>
<td>1.2E-03</td>
<td>NaN</td>
<td>ND</td>
</tr>
</tbody>
</table>

<p>66093 rows × 10 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="remap-value-dl-dlv" class="level2">
<h2 class="anchored" data-anchor-id="remap-value-dl-dlv">Remap <code>VALUE</code>, <code>DL</code>, <code>DLV</code></h2>
<p>We remap <code>DL</code> (Detection Limit) value to MARIS ids as follows:</p>
<ul>
<li>First check if activity (<code>VALUE</code>) is reported as “ND”, based on reported detection limit <code>DL</code>:</li>
</ul>
<pre><code>if VALUE is "ND":
    if not DL: 
        VALUE, DLV, DL = NaN, NaN, 3
    else:
        VALUE, DLV, DL = DL, DL, 2</code></pre>
<ul>
<li>Then if activity (<code>VALUE</code>) is reported:</li>
</ul>
<pre><code>if VALUE:
    VALUE, DLV, DL = VALUE, DL, 1</code></pre>
<p>but if not reported, then based on detection level (<code>DL</code>) reported:</p>
<pre><code>else:
    if DL:
        VALUE, DLV, DL = DL, DL, 2
    else:
        VALUE, DLV, DL = NaN, NaN, NaN (should be dropped)</code></pre>
<p>With 1: Detected value (=), 2: Detection limit (&lt;), 3: Not detected (ND) and where:</p>
<ul>
<li><code>VALUE</code> is the activity reported by TEPCO</li>
<li><code>DL</code> is initially the detection limit as reported by TEPCO but later on remapped to MARIS detection level nomenclature (categorical)</li>
<li><code>DLV</code> is the detection limit value as reported by TEPCO (copied from <code>DL</code>)</li>
</ul>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L369" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="remapvalue_dl_dlv_cb" class="level3">
<h3 class="anchored" data-anchor-id="remapvalue_dl_dlv_cb">RemapVALUE_DL_DLV_CB</h3>
<blockquote class="blockquote">
<pre><code> RemapVALUE_DL_DLV_CB ()</code></pre>
</blockquote>
<p><em>Remap <code>DL</code>, <code>DLV</code>, <code>VALUE</code> based on TEPCO -&gt; MARIS rules.</em></p>
<div id="5303c1cd" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> RemapVALUE_DL_DLV_CB(Callback):</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Remap `DL`, `DLV`, `VALUE` based on TEPCO -&gt; MARIS rules."</span>    </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> map_all_columns(<span class="va">self</span>, row):</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Map all three columns (VALUE, DL, DLV) at once based on TEPCO rules"""</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>        value, dl <span class="op">=</span> row[<span class="st">'VALUE'</span>], row[<span class="st">'DL'</span>]</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>        new_value, new_dlv, new_dl <span class="op">=</span> value, dl, <span class="dv">1</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> value <span class="op">==</span> <span class="st">'ND'</span>:</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pd.isna(dl):</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>                new_value, new_dlv, new_dl <span class="op">=</span> np.nan, np.nan, <span class="dv">3</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>                new_value, new_dlv, new_dl <span class="op">=</span> dl, dl, <span class="dv">2</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> pd.isna(value):</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pd.isna(dl):</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>                new_value, new_dlv, new_dl <span class="op">=</span> np.nan, np.nan, np.nan</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>                new_value, new_dlv, new_dl <span class="op">=</span> dl, dl, <span class="dv">2</span></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.Series({</span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">'VALUE'</span>: new_value,</span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">'DLV'</span>: new_dlv, </span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">'DL'</span>: new_dl</span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, tfm):</span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a>        mapped <span class="op">=</span> tfm.dfs[<span class="st">'SEAWATER'</span>].<span class="bu">apply</span>(<span class="va">self</span>.map_all_columns, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>][[<span class="st">'VALUE'</span>, <span class="st">'DLV'</span>, <span class="st">'DL'</span>]] <span class="op">=</span> mapped</span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'DL'</span>] <span class="op">=</span> tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'DL'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'VALUE'</span>] <span class="op">=</span> tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'VALUE'</span>].astype(<span class="bu">float</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="d566a4f2" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB(),</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    FixRangeValueStringCB(),</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>    SelectColsOfInterestCB(common_coi, nuclides_pattern),</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>    WideToLongCB(),</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>    ExtractNuclideNameCB(),</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>    ExtractUnitCB(),</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>    ExtractValueTypeCB(),</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>    LongToWideCB(),</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>    RemapUnitNameCB(unit_mapping),</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>    RemapNuclideNameCB(nuclide_mapping),</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>    RemapVALUE_DL_DLV_CB()</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> tfm()[<span class="st">'SEAWATER'</span>] </span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>df_test.sample(<span class="dv">20</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">SMP_ID</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">NUCLIDE</th>
<th data-quarto-table-cell-role="th">UNIT</th>
<th data-quarto-table-cell-role="th">DL</th>
<th data-quarto-table-cell-role="th">UNC</th>
<th data-quarto-table-cell-role="th">VALUE</th>
<th data-quarto-table-cell-role="th">DLV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">24313</th>
<td>24313</td>
<td>141.033611</td>
<td>37.415833</td>
<td>2017/10/19 06:50:00</td>
<td>T-2</td>
<td>33</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>0.7100</td>
<td>0.71</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">81171</th>
<td>81171</td>
<td>141.083333</td>
<td>37.750000</td>
<td>2011/11/22 07:10:00</td>
<td>T-MA</td>
<td>33</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>1.1000</td>
<td>1.1E+00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">62025</th>
<td>62025</td>
<td>141.046667</td>
<td>37.423333</td>
<td>2018/01/05 07:37:00</td>
<td>T-0-2</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>1.7000</td>
<td>1.7</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">61732</th>
<td>61732</td>
<td>141.046667</td>
<td>37.423333</td>
<td>2016/08/10 07:54</td>
<td>T-0-2</td>
<td>33</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>0.5300</td>
<td>0.53</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">52714</th>
<td>52714</td>
<td>141.040278</td>
<td>37.416111</td>
<td>2023/11/06 06:56:00</td>
<td>T-0-3</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>0.3000</td>
<td>0.3</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9189</th>
<td>9189</td>
<td>140.763889</td>
<td>36.713889</td>
<td>2012/2/28 07:41:00</td>
<td>T-A</td>
<td>29</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>1.2000</td>
<td>1.2E+00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16645</th>
<td>16645</td>
<td>141.022500</td>
<td>37.824444</td>
<td>2022/10/6 05:44:00</td>
<td>T-22</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>0.0013</td>
<td>1.3E-03</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">24544</th>
<td>24544</td>
<td>141.033611</td>
<td>37.415833</td>
<td>2017/12/15 06:55:00</td>
<td>T-2</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>0.5500</td>
<td>0.55</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">69344</th>
<td>69344</td>
<td>141.050761</td>
<td>37.424686</td>
<td>2023/03/27 07:26:00</td>
<td>T-A2</td>
<td>33</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>0.2900</td>
<td>0.29</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">21783</th>
<td>21783</td>
<td>141.033611</td>
<td>37.415833</td>
<td>2012/05/29 08:15:00</td>
<td>T-2</td>
<td>33</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>1.6000</td>
<td>1.6</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">30460</th>
<td>30460</td>
<td>141.033611</td>
<td>37.415833</td>
<td>2022/07/11 09:13:00</td>
<td>T-2</td>
<td>103</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>14.0000</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">29837</th>
<td>29837</td>
<td>141.033611</td>
<td>37.415833</td>
<td>2022/01/03 08:15:00</td>
<td>T-2</td>
<td>33</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>0.8700</td>
<td>0.87</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">9304</th>
<td>9304</td>
<td>140.763889</td>
<td>36.713889</td>
<td>2014/11/10 09:34:00</td>
<td>T-A</td>
<td>33</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>1.3000</td>
<td>1.3E+00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">28727</th>
<td>28727</td>
<td>141.033611</td>
<td>37.415833</td>
<td>2021/01/28 07:05:00</td>
<td>T-2</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>0.8000</td>
<td>0.8</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">42442</th>
<td>42442</td>
<td>141.034444</td>
<td>37.431111</td>
<td>2017/11/27 07:05:00</td>
<td>T-1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>1.9000</td>
<td>1.9</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">24596</th>
<td>24596</td>
<td>141.033611</td>
<td>37.415833</td>
<td>2017/12/28 06:55:00</td>
<td>T-2</td>
<td>103</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>12.0000</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6689</th>
<td>6689</td>
<td>140.603889</td>
<td>36.299722</td>
<td>2019/10/18 13:06:00</td>
<td>T-C</td>
<td>33</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>1.2000</td>
<td>1.2E+00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">35904</th>
<td>35904</td>
<td>141.034444</td>
<td>37.431111</td>
<td>2012/05/28 08:55:00</td>
<td>T-1</td>
<td>29</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>0.4900</td>
<td>0.49</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">15422</th>
<td>15422</td>
<td>141.013889</td>
<td>37.241667</td>
<td>2017/12/5 13:30:00</td>
<td>T-4</td>
<td>31</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>0.0038</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">59538</th>
<td>59538</td>
<td>141.046667</td>
<td>37.416111</td>
<td>2018/08/28 07:22:00</td>
<td>T-0-3A</td>
<td>103</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>15.0000</td>
<td>15.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="convert-activity-to-bqm3" class="level2">
<h2 class="anchored" data-anchor-id="convert-activity-to-bqm3">Convert activity to <code>Bq/m3</code></h2>
<p>Earlier in the pipeline, we assigned MARIS <code>unit_id</code> = 3 (Bq/L) to TEPCO <code>UNIT</code> = <code>Bq/L</code>. Now we need to convert the values from Bq/L to Bq/m3 by multiplying VALUE, DL, and DLV by 1000.</p>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/tepco.py#L401" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="converttobqm3cb" class="level3">
<h3 class="anchored" data-anchor-id="converttobqm3cb">ConvertToBqM3CB</h3>
<blockquote class="blockquote">
<pre><code> ConvertToBqM3CB ()</code></pre>
</blockquote>
<p><em>Convert from Bq/L to Bq/m3.</em></p>
<div id="6936aed6" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ConvertToBqM3CB(Callback):</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Convert from Bq/L to Bq/m3."</span>    </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, tfm, factor<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'VALUE'</span>] <span class="op">=</span> tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'VALUE'</span>] <span class="op">*</span> factor</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert DLV to float, handling NaN values</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'DLV'</span>] <span class="op">=</span> pd.to_numeric(tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'DLV'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'DLV'</span>] <span class="op">=</span> tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'DLV'</span>] <span class="op">*</span> factor</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="eab83fcf" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB(),</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>    FixRangeValueStringCB(),</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    SelectColsOfInterestCB(common_coi, nuclides_pattern),</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>    WideToLongCB(),</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>    ExtractNuclideNameCB(),</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>    ExtractUnitCB(),</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>    ExtractValueTypeCB(),</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>    LongToWideCB(),</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>    RemapUnitNameCB(unit_mapping),</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>    RemapNuclideNameCB(nuclide_mapping),</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>    RemapVALUE_DL_DLV_CB(),</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>    ConvertToBqM3CB()</span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> tfm()[<span class="st">'SEAWATER'</span>] </span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>df_test.sample(<span class="dv">20</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">SMP_ID</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">NUCLIDE</th>
<th data-quarto-table-cell-role="th">UNIT</th>
<th data-quarto-table-cell-role="th">DL</th>
<th data-quarto-table-cell-role="th">UNC</th>
<th data-quarto-table-cell-role="th">VALUE</th>
<th data-quarto-table-cell-role="th">DLV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">11653</th>
<td>11653</td>
<td>140.922222</td>
<td>36.905556</td>
<td>2018/7/17 09:28:00</td>
<td>T-18</td>
<td>33</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>3.1</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">56255</th>
<td>56255</td>
<td>141.040556</td>
<td>37.478889</td>
<td>2015/8/11 08:00:00</td>
<td>T-6</td>
<td>33</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>57.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4414</th>
<td>4414</td>
<td>37.410000</td>
<td>141.030000</td>
<td>2015/07/13 05:30:00</td>
<td>T-2-1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>2100.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">71352</th>
<td>71352</td>
<td>141.062500</td>
<td>37.552778</td>
<td>2015/7/27 08:36:00</td>
<td>T-14</td>
<td>31</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>2.0</td>
<td>1.4</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">28640</th>
<td>28640</td>
<td>141.033611</td>
<td>37.415833</td>
<td>2021/01/01 07:11:00</td>
<td>T-2</td>
<td>103</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>15000.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">51235</th>
<td>51235</td>
<td>141.040278</td>
<td>37.416111</td>
<td>2017/01/02 07:16:00</td>
<td>T-0-3</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>680.0</td>
<td>680.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">66512</th>
<td>66512</td>
<td>141.046667</td>
<td>37.430556</td>
<td>2025/04/29 07:18</td>
<td>T-0-1A</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>8100.0</td>
<td>8100.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">49336</th>
<td>49336</td>
<td>141.034444</td>
<td>37.431111</td>
<td>2025/03/29 06:50</td>
<td>T-1</td>
<td>33</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>660.0</td>
<td>660.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">71187</th>
<td>71187</td>
<td>141.062500</td>
<td>37.552778</td>
<td>2014/2/26 09:09:00</td>
<td>T-14</td>
<td>33</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>48.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">32088</th>
<td>32088</td>
<td>141.033611</td>
<td>37.415833</td>
<td>2023/10/27 06:45:00</td>
<td>T-2</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>750.0</td>
<td>750.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">34498</th>
<td>34498</td>
<td>141.034444</td>
<td>37.431111</td>
<td>2011/04/20 14:20:00</td>
<td>T-1</td>
<td>29</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>47000.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">76600</th>
<td>76600</td>
<td>141.072222</td>
<td>37.416667</td>
<td>2022/6/1 08:40:00</td>
<td>T-D5</td>
<td>104</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>2500.0</td>
<td>2500.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">51215</th>
<td>51215</td>
<td>141.040278</td>
<td>37.416111</td>
<td>2016/11/28 07:47:00</td>
<td>T-0-3</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>790.0</td>
<td>790.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">28565</th>
<td>28565</td>
<td>141.033611</td>
<td>37.415833</td>
<td>2020/12/09 06:45:00</td>
<td>T-2</td>
<td>33</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>690.0</td>
<td>690.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">28344</th>
<td>28344</td>
<td>141.033611</td>
<td>37.415833</td>
<td>2020/10/04 06:45:00</td>
<td>T-2</td>
<td>103</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>13000.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">70632</th>
<td>70632</td>
<td>141.062500</td>
<td>37.552778</td>
<td>2011/10/25 09:10:00</td>
<td>T-14</td>
<td>29</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>740.0</td>
<td>740.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">7440</th>
<td>7440</td>
<td>140.665556</td>
<td>36.506389</td>
<td>2014/5/26 13:38:00</td>
<td>T-B</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>1100.0</td>
<td>1100.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">20878</th>
<td>20878</td>
<td>141.033611</td>
<td>37.415833</td>
<td>2011/10/03 08:30:00</td>
<td>T-2</td>
<td>29</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>4000.0</td>
<td>4000.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4115</th>
<td>4115</td>
<td>37.410000</td>
<td>141.030000</td>
<td>2015/04/27 05:30:00</td>
<td>T-2-1</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>770.0</td>
<td>770.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">44483</th>
<td>44483</td>
<td>141.034444</td>
<td>37.431111</td>
<td>2019/10/01 08:05:00</td>
<td>T-1</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>840.0</td>
<td>840.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="parse-encode-time" class="level2">
<h2 class="anchored" data-anchor-id="parse-encode-time">Parse &amp; encode time</h2>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/geotraces.py#L246" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="parsetimecb" class="level3">
<h3 class="anchored" data-anchor-id="parsetimecb">ParseTimeCB</h3>
<blockquote class="blockquote">
<pre><code> ParseTimeCB (time_name='TIME')</code></pre>
</blockquote>
<p><em>Parse time column from TEPCO.</em></p>
<div id="eba06615" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ParseTimeCB(Callback):</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Parse time column from TEPCO."</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, time_name<span class="op">=</span><span class="st">'TIME'</span>): fc.store_attr()</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, tfm):</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="va">self</span>.time_name] <span class="op">=</span> pd.to_datetime(tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="va">self</span>.time_name], </span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>                                                             <span class="bu">format</span><span class="op">=</span><span class="st">'%Y/%m/</span><span class="sc">%d</span><span class="st"> %H:%M:%S'</span>, errors<span class="op">=</span><span class="st">'coerce'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="02cafecd" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB(),</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>    FixRangeValueStringCB(),</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>    SelectColsOfInterestCB(common_coi, nuclides_pattern),</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>    WideToLongCB(),</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>    ExtractNuclideNameCB(),</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>    ExtractUnitCB(),</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>    ExtractValueTypeCB(),</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>    LongToWideCB(),</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>    RemapUnitNameCB(unit_mapping),</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>    RemapNuclideNameCB(nuclide_mapping),</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>    RemapVALUE_DL_DLV_CB(),</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>    ConvertToBqM3CB(),</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>    ParseTimeCB(),</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>    EncodeTimeCB(),</span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> tfm()[<span class="st">'SEAWATER'</span>] </span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>df_test.sample(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: 4831 missing time value(s) in SEAWATER</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">SMP_ID</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">NUCLIDE</th>
<th data-quarto-table-cell-role="th">UNIT</th>
<th data-quarto-table-cell-role="th">DL</th>
<th data-quarto-table-cell-role="th">UNC</th>
<th data-quarto-table-cell-role="th">VALUE</th>
<th data-quarto-table-cell-role="th">DLV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">69085</th>
<td>69085</td>
<td>141.050739</td>
<td>37.409267</td>
<td>1733731260</td>
<td>T-A3</td>
<td>33</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>320.0</td>
<td>320.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">44340</th>
<td>44340</td>
<td>141.034444</td>
<td>37.431111</td>
<td>1564646400</td>
<td>T-1</td>
<td>33</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>720.0</td>
<td>720.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">30532</th>
<td>30532</td>
<td>141.033611</td>
<td>37.415833</td>
<td>1659345300</td>
<td>T-2</td>
<td>103</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>7000.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">42965</th>
<td>42965</td>
<td>141.034444</td>
<td>37.431111</td>
<td>1525677000</td>
<td>T-1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>880.0</td>
<td>880.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14651</th>
<td>14651</td>
<td>141.013889</td>
<td>37.241667</td>
<td>1315813500</td>
<td>T-4</td>
<td>29</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>4000.0</td>
<td>4000.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="sanitize-coordinates" class="level2">
<h2 class="anchored" data-anchor-id="sanitize-coordinates">Sanitize coordinates</h2>
<div id="554f8c2b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB(),</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    FixRangeValueStringCB(),</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    SelectColsOfInterestCB(common_coi, nuclides_pattern),</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    WideToLongCB(),</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    ExtractNuclideNameCB(),</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>    ExtractUnitCB(),</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>    ExtractValueTypeCB(),</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>    LongToWideCB(),</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>    RemapUnitNameCB(unit_mapping),</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>    RemapNuclideNameCB(nuclide_mapping),</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>    RemapVALUE_DL_DLV_CB(),</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    ConvertToBqM3CB(),</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>    ParseTimeCB(),</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>    EncodeTimeCB(),</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>    SanitizeLonLatCB()</span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> tfm()[<span class="st">'SEAWATER'</span>]</span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>df_test.sample(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: 4831 missing time value(s) in SEAWATER</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">SMP_ID</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">NUCLIDE</th>
<th data-quarto-table-cell-role="th">UNIT</th>
<th data-quarto-table-cell-role="th">DL</th>
<th data-quarto-table-cell-role="th">UNC</th>
<th data-quarto-table-cell-role="th">VALUE</th>
<th data-quarto-table-cell-role="th">DLV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">54074</th>
<td>54074</td>
<td>141.040278</td>
<td>37.430556</td>
<td>1515394980</td>
<td>T-0-1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>1700.0</td>
<td>1700.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">74378</th>
<td>74378</td>
<td>141.072167</td>
<td>37.333333</td>
<td>1681804920</td>
<td>T-D9</td>
<td>103</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>14000.0</td>
<td>14000.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">91213</th>
<td>91213</td>
<td>141.583333</td>
<td>38.633333</td>
<td>1377003060</td>
<td>T-MG0</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>2.2</td>
<td>2.2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">72667</th>
<td>72667</td>
<td>141.072167</td>
<td>37.333333</td>
<td>1380362220</td>
<td>T-D9</td>
<td>31</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>23.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">86114</th>
<td>86114</td>
<td>141.200000</td>
<td>37.416667</td>
<td>1638775740</td>
<td>T-5</td>
<td>104</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>2300.0</td>
<td>2300.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="add-sample-id" class="level2">
<h2 class="anchored" data-anchor-id="add-sample-id">Add Sample ID</h2>
<p>The <code>SMP_ID_PROVIDER</code> column stores the original sample ID from the data provider. TEPCO does not provide sample IDs, so this column will be set to None for all records.</p>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/ospar.py#L431" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="addsampleidcb" class="level3">
<h3 class="anchored" data-anchor-id="addsampleidcb">AddSampleIdCB</h3>
<blockquote class="blockquote">
<pre><code> AddSampleIdCB ()</code></pre>
</blockquote>
<p><em>Convert from Bq/L to Bq/m3.</em></p>
<div id="8e2c115b" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AddSampleIdCB(Callback):</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Convert from Bq/L to Bq/m3."</span>    </span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, tfm, factor<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'SMP_ID'</span>] <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(tfm.dfs[<span class="st">'SEAWATER'</span>]) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>        tfm.dfs[<span class="st">'SEAWATER'</span>][<span class="st">'SMP_ID_PROVIDER'</span>] <span class="op">=</span> <span class="st">""</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="39913e94" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB(),</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>    FixRangeValueStringCB(),</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>    SelectColsOfInterestCB(common_coi, nuclides_pattern),</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>    WideToLongCB(),</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>    ExtractNuclideNameCB(),</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>    ExtractUnitCB(),</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>    ExtractValueTypeCB(),</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>    LongToWideCB(),</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>    RemapUnitNameCB(unit_mapping),</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>    RemapNuclideNameCB(nuclide_mapping),</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>    RemapVALUE_DL_DLV_CB(),</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>    ConvertToBqM3CB(),</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>    ParseTimeCB(),</span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>    EncodeTimeCB(),</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>    SanitizeLonLatCB(),</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>    AddSampleIdCB(),</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> tfm()[<span class="st">'SEAWATER'</span>]</span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>df_test.sample(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: 4831 missing time value(s) in SEAWATER</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">SMP_ID</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">NUCLIDE</th>
<th data-quarto-table-cell-role="th">UNIT</th>
<th data-quarto-table-cell-role="th">DL</th>
<th data-quarto-table-cell-role="th">UNC</th>
<th data-quarto-table-cell-role="th">VALUE</th>
<th data-quarto-table-cell-role="th">DLV</th>
<th data-quarto-table-cell-role="th">SMP_ID_PROVIDER</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">67223</th>
<td>57586</td>
<td>141.047222</td>
<td>37.241667</td>
<td>1448351640</td>
<td>T-11</td>
<td>31</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>3.5</td>
<td>NaN</td>
<td></td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">42868</th>
<td>35125</td>
<td>141.034444</td>
<td>37.431111</td>
<td>1523173800</td>
<td>T-1</td>
<td>33</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>450.0</td>
<td>450.0</td>
<td></td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">44015</th>
<td>36272</td>
<td>141.034444</td>
<td>37.431111</td>
<td>1553155800</td>
<td>T-1</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>760.0</td>
<td>760.0</td>
<td></td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">42519</th>
<td>34776</td>
<td>141.034444</td>
<td>37.431111</td>
<td>1513755900</td>
<td>T-1</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>540.0</td>
<td>540.0</td>
<td></td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">13882</th>
<td>7902</td>
<td>141.013889</td>
<td>37.241667</td>
<td>1318838400</td>
<td>T-4</td>
<td>29</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>4000.0</td>
<td>4000.0</td>
<td></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="encode-to-netcdf" class="level2">
<h2 class="anchored" data-anchor-id="encode-to-netcdf">Encode to NetCDF</h2>
<div id="bee58450" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>    RemoveJapanaseCharCB(),</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>    FixRangeValueStringCB(),</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>    SelectColsOfInterestCB(common_coi, nuclides_pattern),</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>    WideToLongCB(),</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>    ExtractNuclideNameCB(),</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>    ExtractUnitCB(),</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>    ExtractValueTypeCB(),</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>    LongToWideCB(),</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>    RemapUnitNameCB(unit_mapping),</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>    RemapNuclideNameCB(nuclide_mapping),</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>    RemapVALUE_DL_DLV_CB(),</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>    ConvertToBqM3CB(),</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>    ParseTimeCB(),</span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>    EncodeTimeCB(),</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>    SanitizeLonLatCB(),</span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>    AddSampleIdCB(),</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a>dfs_tfm <span class="op">=</span> tfm()</span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a>tfm.logs</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: 4831 missing time value(s) in SEAWATER</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>['Remove 約 (about) char',
 "Replace range values (e.g '4.0E+00&lt;&amp;&lt;8.0E+00' or '1.0～2.7') by their mean",
 'Select columns of interest.',
 '\n    Get TEPCO nuclide names as values not column names \n    to extract contained information (nuclide name, unc, dl, ...).\n    ',
 'Extract nuclide name from TEPCO data.',
 'Extract unit from TEPCO data.',
 'Extract value type from TEPCO data.',
 'Reshape: long to wide',
 '\n    Remap `UNIT` name to MARIS id.\n    ',
 'Remap `NUCLIDE` name to MARIS id.',
 'Remap `DL`, `DLV`, `VALUE` based on TEPCO -&gt; MARIS rules.',
 'Convert from Bq/L to Bq/m3.',
 'Parse time column from TEPCO.',
 'Encode time as seconds since epoch.',
 'Drop rows with invalid longitude &amp; latitude values. Convert `,` separator to `.` separator.',
 'Convert from Bq/L to Bq/m3.']</code></pre>
</div>
</div>
<div id="d992bb5f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>dfs_tfm[<span class="st">'SEAWATER'</span>].sample(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">SMP_ID</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">TIME</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">NUCLIDE</th>
<th data-quarto-table-cell-role="th">UNIT</th>
<th data-quarto-table-cell-role="th">DL</th>
<th data-quarto-table-cell-role="th">UNC</th>
<th data-quarto-table-cell-role="th">VALUE</th>
<th data-quarto-table-cell-role="th">DLV</th>
<th data-quarto-table-cell-role="th">SMP_ID_PROVIDER</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">64028</th>
<td>54701</td>
<td>141.046667</td>
<td>37.430556</td>
<td>1408352280</td>
<td>T-0-1A</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>1700.0</td>
<td>1700.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">82446</th>
<td>72534</td>
<td>141.133333</td>
<td>38.250000</td>
<td>1522926600</td>
<td>T-MG4</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>1.5</td>
<td>1.5</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">39583</th>
<td>32834</td>
<td>141.034444</td>
<td>37.431111</td>
<td>1438068000</td>
<td>T-1</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>790.0</td>
<td>790.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">32941</th>
<td>26702</td>
<td>141.033611</td>
<td>37.415833</td>
<td>1719583500</td>
<td>T-2</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>640.0</td>
<td>640.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">31333</th>
<td>25094</td>
<td>141.033611</td>
<td>37.415833</td>
<td>1680244980</td>
<td>T-2</td>
<td>33</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>740.0</td>
<td>740.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">87087</th>
<td>77175</td>
<td>141.216667</td>
<td>37.533333</td>
<td>1659696300</td>
<td>T-B1</td>
<td>33</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>1.4</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">83010</th>
<td>73098</td>
<td>141.148611</td>
<td>37.348333</td>
<td>1647327180</td>
<td>T-B4</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>1.4</td>
<td>1.4</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">65263</th>
<td>55757</td>
<td>141.046667</td>
<td>37.430556</td>
<td>1594621980</td>
<td>T-0-1A</td>
<td>33</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>750.0</td>
<td>750.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">87045</th>
<td>77133</td>
<td>141.216667</td>
<td>37.533333</td>
<td>1614322020</td>
<td>T-B1</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>NaN</td>
<td>1.2</td>
<td>1.2</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">13558</th>
<td>7578</td>
<td>141.006944</td>
<td>37.055556</td>
<td>1380524760</td>
<td>T-17-1</td>
<td>33</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>8.7</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/geotraces.py#L269" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="get_attrs" class="level3">
<h3 class="anchored" data-anchor-id="get_attrs">get_attrs</h3>
<blockquote class="blockquote">
<pre><code> get_attrs (tfm, zotero_key, kw=['oceanography', 'Earth Science &gt; Oceans &gt;
            Ocean Chemistry&gt; Radionuclides', 'Earth Science &gt; Human
            Dimensions &gt; Environmental Impacts &gt; Nuclear Radiation
            Exposure', 'Earth Science &gt; Oceans &gt; Ocean Chemistry &gt; Ocean
            Tracers, Earth Science &gt; Oceans &gt; Marine Sediments', 'Earth
            Science &gt; Oceans &gt; Ocean Chemistry, Earth Science &gt; Oceans &gt;
            Sea Ice &gt; Isotopes', 'Earth Science &gt; Oceans &gt; Water Quality &gt;
            Ocean Contaminants', 'Earth Science &gt; Biological
            Classification &gt; Animals/Vertebrates &gt; Fish', 'Earth Science &gt;
            Biosphere &gt; Ecosystems &gt; Marine Ecosystems', 'Earth Science &gt;
            Biological Classification &gt; Animals/Invertebrates &gt; Mollusks',
            'Earth Science &gt; Biological Classification &gt;
            Animals/Invertebrates &gt; Arthropods &gt; Crustaceans', 'Earth
            Science &gt; Biological Classification &gt; Plants &gt; Macroalgae
            (Seaweeds)'])</code></pre>
</blockquote>
<p><em>Retrieve global attributes from MARIS dump.</em></p>
<div id="b02e469f" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>kw <span class="op">=</span> [<span class="st">'oceanography'</span>, <span class="st">'Earth Science &gt; Oceans &gt; Ocean Chemistry&gt; Radionuclides'</span>,</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>      <span class="st">'Earth Science &gt; Human Dimensions &gt; Environmental Impacts &gt; Nuclear Radiation Exposure'</span>,</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>      <span class="st">'Earth Science &gt; Oceans &gt; Ocean Chemistry &gt; Ocean Tracers, Earth Science &gt; Oceans &gt; Marine Sediments'</span>,</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">'Earth Science &gt; Oceans &gt; Ocean Chemistry, Earth Science &gt; Oceans &gt; Sea Ice &gt; Isotopes'</span>,</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">'Earth Science &gt; Oceans &gt; Water Quality &gt; Ocean Contaminants'</span>,</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">'Earth Science &gt; Biological Classification &gt; Animals/Vertebrates &gt; Fish'</span>,</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">'Earth Science &gt; Biosphere &gt; Ecosystems &gt; Marine Ecosystems'</span>,</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">'Earth Science &gt; Biological Classification &gt; Animals/Invertebrates &gt; Mollusks'</span>,</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">'Earth Science &gt; Biological Classification &gt; Animals/Invertebrates &gt; Arthropods &gt; Crustaceans'</span>,</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">'Earth Science &gt; Biological Classification &gt; Plants &gt; Macroalgae (Seaweeds)'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="7f72c03b" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_attrs(tfm, zotero_key, kw<span class="op">=</span>kw):</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Retrieve global attributes from MARIS dump."</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> GlobAttrsFeeder(tfm.dfs, cbs<span class="op">=</span>[</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>        BboxCB(),</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>        TimeRangeCB(),</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>        ZoteroCB(zotero_key, cfg<span class="op">=</span>cfg()),</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>        KeyValuePairCB(<span class="st">'keywords'</span>, <span class="st">', '</span>.join(kw)),</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>        KeyValuePairCB(<span class="st">'publisher_postprocess_logs'</span>, <span class="st">', '</span>.join(tfm.logs))</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>        ])()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="d8744b76" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>get_attrs(tfm, zotero_key<span class="op">=</span><span class="st">'JEV6HP5A'</span>, kw<span class="op">=</span>kw)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>{'geospatial_lat_min': '141.66666667',
 'geospatial_lat_max': '38.63333333',
 'geospatial_lon_min': '140.60388889',
 'geospatial_lon_max': '35.79611111',
 'geospatial_bounds': 'POLYGON ((140.60388889 35.79611111, 141.66666667 35.79611111, 141.66666667 38.63333333, 140.60388889 38.63333333, 140.60388889 35.79611111))',
 'time_coverage_start': '2011-03-21T14:30:00',
 'time_coverage_end': '2025-07-22T06:17:00',
 'id': 'JEV6HP5A',
 'title': "Readings of Sea Area Monitoring - Monitoring of sea water - Sea area close to TEPCO's Fukushima Daiichi NPS / Coastal area - Readings of Sea Area Monitoring [TEPCO]",
 'summary': '',
 'creator_name': '[{"creatorType": "author", "firstName": "", "lastName": "TEPCO - Tokyo Electric Power Company"}]',
 'keywords': 'oceanography, Earth Science &gt; Oceans &gt; Ocean Chemistry&gt; Radionuclides, Earth Science &gt; Human Dimensions &gt; Environmental Impacts &gt; Nuclear Radiation Exposure, Earth Science &gt; Oceans &gt; Ocean Chemistry &gt; Ocean Tracers, Earth Science &gt; Oceans &gt; Marine Sediments, Earth Science &gt; Oceans &gt; Ocean Chemistry, Earth Science &gt; Oceans &gt; Sea Ice &gt; Isotopes, Earth Science &gt; Oceans &gt; Water Quality &gt; Ocean Contaminants, Earth Science &gt; Biological Classification &gt; Animals/Vertebrates &gt; Fish, Earth Science &gt; Biosphere &gt; Ecosystems &gt; Marine Ecosystems, Earth Science &gt; Biological Classification &gt; Animals/Invertebrates &gt; Mollusks, Earth Science &gt; Biological Classification &gt; Animals/Invertebrates &gt; Arthropods &gt; Crustaceans, Earth Science &gt; Biological Classification &gt; Plants &gt; Macroalgae (Seaweeds)',
 'publisher_postprocess_logs': "Remove 約 (about) char, Replace range values (e.g '4.0E+00&lt;&amp;&lt;8.0E+00' or '1.0～2.7') by their mean, Select columns of interest., \n    Get TEPCO nuclide names as values not column names \n    to extract contained information (nuclide name, unc, dl, ...).\n    , Extract nuclide name from TEPCO data., Extract unit from TEPCO data., Extract value type from TEPCO data., Reshape: long to wide, \n    Remap `UNIT` name to MARIS id.\n    , Remap `NUCLIDE` name to MARIS id., Remap `DL`, `DLV`, `VALUE` based on TEPCO -&gt; MARIS rules., Convert from Bq/L to Bq/m3., Parse time column from TEPCO., Encode time as seconds since epoch., Drop rows with invalid longitude &amp; latitude values. Convert `,` separator to `.` separator., Convert from Bq/L to Bq/m3."}</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/franckalbinet/marisco/blob/main/marisco/handlers/geotraces.py#L281" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="encode" class="level3">
<h3 class="anchored" data-anchor-id="encode">encode</h3>
<blockquote class="blockquote">
<pre><code> encode (fname_out:str, **kwargs)</code></pre>
</blockquote>
<p><em>Encode TEPCO data to NetCDF.</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>fname_out</td>
<td>str</td>
<td>Path to the folder where the NetCDF output will be saved</td>
</tr>
<tr class="even">
<td>kwargs</td>
<td>VAR_KEYWORD</td>
<td></td>
</tr>
</tbody>
</table>
<div id="b1db1a74" class="cell">
<details open="" class="code-fold">
<summary>Exported source</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> encode(</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>    fname_out: <span class="bu">str</span>, <span class="co"># Path to the folder where the NetCDF output will be saved</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs <span class="co"># Additional keyword arguments</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Encode TEPCO data to NetCDF."</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>    dfs <span class="op">=</span> load_data(fname_coastal_water, fname_clos1F, fname_iaea_orbs)</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>    tfm <span class="op">=</span> Transformer(dfs, cbs<span class="op">=</span>[</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>        RemoveJapanaseCharCB(),</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>        FixRangeValueStringCB(),</span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>        SelectColsOfInterestCB(common_coi, nuclides_pattern),</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>        WideToLongCB(),</span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>        ExtractNuclideNameCB(),</span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a>        ExtractUnitCB(),</span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a>        ExtractValueTypeCB(),</span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a>        LongToWideCB(),</span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a>        RemapUnitNameCB(unit_mapping),</span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a>        RemapNuclideNameCB(nuclide_mapping),</span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a>        RemapVALUE_DL_DLV_CB(),</span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a>        ConvertToBqM3CB(),</span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a>        ParseTimeCB(),</span>
<span id="cb138-22"><a href="#cb138-22" aria-hidden="true" tabindex="-1"></a>        EncodeTimeCB(),</span>
<span id="cb138-23"><a href="#cb138-23" aria-hidden="true" tabindex="-1"></a>        SanitizeLonLatCB(),</span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a>        AddSampleIdCB()</span>
<span id="cb138-25"><a href="#cb138-25" aria-hidden="true" tabindex="-1"></a>    ])        </span>
<span id="cb138-26"><a href="#cb138-26" aria-hidden="true" tabindex="-1"></a>    tfm()</span>
<span id="cb138-27"><a href="#cb138-27" aria-hidden="true" tabindex="-1"></a>    encoder <span class="op">=</span> NetCDFEncoder(tfm.dfs, </span>
<span id="cb138-28"><a href="#cb138-28" aria-hidden="true" tabindex="-1"></a>                            dest_fname<span class="op">=</span>fname_out, </span>
<span id="cb138-29"><a href="#cb138-29" aria-hidden="true" tabindex="-1"></a>                            global_attrs<span class="op">=</span>get_attrs(tfm, zotero_key<span class="op">=</span><span class="st">'JEV6HP5A'</span>, kw<span class="op">=</span>kw),</span>
<span id="cb138-30"><a href="#cb138-30" aria-hidden="true" tabindex="-1"></a>                            verbose<span class="op">=</span>kwargs.get(<span class="st">'verbose'</span>, <span class="va">False</span>)</span>
<span id="cb138-31"><a href="#cb138-31" aria-hidden="true" tabindex="-1"></a>                            )</span>
<span id="cb138-32"><a href="#cb138-32" aria-hidden="true" tabindex="-1"></a>    encoder.encode()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="63d26d4f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>encode(fname_out, verbose<span class="op">=</span><span class="va">False</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 11/11 [00:05&lt;00:00,  2.17it/s]
100%|██████████| 11/11 [00:05&lt;00:00,  2.14it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: 4831 missing time value(s) in SEAWATER</code></pre>
</div>
</div>
<div id="cbe8d252" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>decode(fname_in<span class="op">=</span>fname_out, verbose<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Saved SEAWATER to ../../_data/output/tepco_SEAWATER.csv</code></pre>
</div>
</div>
<div id="10ce4087" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>df_output <span class="op">=</span> pd.read_csv(<span class="st">"../../_data/output/tepco_SEAWATER.csv"</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>df_output.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">samplabcode</th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">begperiod</th>
<th data-quarto-table-cell-role="th">station</th>
<th data-quarto-table-cell-role="th">nuclide_id</th>
<th data-quarto-table-cell-role="th">activity</th>
<th data-quarto-table-cell-role="th">unit_id</th>
<th data-quarto-table-cell-role="th">uncertaint</th>
<th data-quarto-table-cell-role="th">detection</th>
<th data-quarto-table-cell-role="th">detection_lim</th>
<th data-quarto-table-cell-role="th">samptype_id</th>
<th data-quarto-table-cell-role="th">ref_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>NaN</td>
<td>140.60388</td>
<td>36.29972</td>
<td>2011-10-13 13:21:00</td>
<td>T-C</td>
<td>29</td>
<td>4000.0</td>
<td>1</td>
<td>NaN</td>
<td>&lt;</td>
<td>4000.0</td>
<td>1</td>
<td>679</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>NaN</td>
<td>140.60388</td>
<td>36.29972</td>
<td>2011-10-13 13:21:00</td>
<td>T-C</td>
<td>31</td>
<td>6000.0</td>
<td>1</td>
<td>NaN</td>
<td>&lt;</td>
<td>6000.0</td>
<td>1</td>
<td>679</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>NaN</td>
<td>140.60388</td>
<td>36.29972</td>
<td>2011-10-13 13:21:00</td>
<td>T-C</td>
<td>33</td>
<td>9000.0</td>
<td>1</td>
<td>NaN</td>
<td>&lt;</td>
<td>9000.0</td>
<td>1</td>
<td>679</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>NaN</td>
<td>140.60388</td>
<td>36.29972</td>
<td>2011-10-13 13:23:00</td>
<td>T-C</td>
<td>29</td>
<td>4000.0</td>
<td>1</td>
<td>NaN</td>
<td>&lt;</td>
<td>4000.0</td>
<td>1</td>
<td>679</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>NaN</td>
<td>140.60388</td>
<td>36.29972</td>
<td>2011-10-13 13:23:00</td>
<td>T-C</td>
<td>31</td>
<td>6000.0</td>
<td>1</td>
<td>NaN</td>
<td>&lt;</td>
<td>6000.0</td>
<td>1</td>
<td>679</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/franckalbinet\.github\.io\/marisco");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/franckalbinet/marisco/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>
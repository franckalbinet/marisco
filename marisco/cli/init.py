# AUTOGENERATED! DO NOT EDIT! File to edit: ../../nbs/cli/init.ipynb.

# %% auto 0
__all__ = ['cfg_fname', 'cdl_fname', 'main']

# %% ../../nbs/cli/init.ipynb 2
from pathlib import Path
import sys

from fastcore.script import *
from fastcore.xtras import mkdir
from fastcore.style import S

from ..configs import BASE_PATH, CONFIGS, CONFIGS_CDL
from ..utils import write_toml, download_files_in_folder
from . import create_nc_template

# %% ../../nbs/cli/init.ipynb 3
cfg_fname = 'configs.toml'
cdl_fname = 'cdl.toml'

# %% ../../nbs/cli/init.ipynb 4
@call_parse
def main():
    "Create configuration files & download lookup tables"
    if BASE_PATH.exists():
        msg = S.red('Configuration files already exist. Do you want to overwrite them? (y/[n]): ')
        if not input(msg).lower().startswith('y'): 
            sys.exit(1)

    mkdir(BASE_PATH, overwrite=True)
    for k, v in CONFIGS['dirs'].items():
        mkdir(v, parents=True, overwrite=True)
            
    write_toml(BASE_PATH / cfg_fname, CONFIGS)
    write_toml(BASE_PATH / cdl_fname, CONFIGS_CDL) 
    
    # download luts`
    print('Downloading look-up tables ...')
    owner, repo = CONFIGS['gh'].values()
    download_files_in_folder(owner, repo, 
                             src_dir=CONFIGS['paths']['luts'], dest_dir=BASE_PATH / 'lut')
    
    create_nc_template.main()
